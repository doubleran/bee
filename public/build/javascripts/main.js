//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors

//     Underscore may be freely distributed under the MIT license.

//     (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors

//     Backbone may be freely distributed under the MIT license.

//! moment.js
//! version : 2.8.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/*!
 * FullCalendar v2.2.3
 * Docs & License: http://arshaw.com/fullcalendar/
 * (c) 2013 Adam Shaw
 */

(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var T=x.each=x.forEach=function(e,t,r){if(e==null)return e;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else{var o=x.keys(e);for(var i=0,s=o.length;i<s;i++)if(t.call(r,e[o[i]],o[i],e)===n)return}return e};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-Infinity,i=-Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=Infinity,i=Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u<i&&(r=e,i=u)}),r},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return t==null||n?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return e==null?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,n){return t=k(t),x.pluck(x.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={};return n=k(n),T(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};x.groupBy=L(function(e,t,n){x.has(e,t)?e[t].push(n):e[t]=[n]}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:t<0?[]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.partition=function(e,t,n){t=k(t);var r=[],i=[];return T(e,function(e){(t.call(n,e)?r:i).push(e)}),[r,i]},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){var n=0,r=t.slice();for(var i=0,s=r.length;i<s;i++)r[i]===x&&(r[i]=arguments[n++]);while(n<arguments.length)r.push(arguments[n++]);return e.apply(this,r)}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:x.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=x.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=x.now()-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=x.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=function(e){if(!x.isObject(e))return[];if(E)return E(e);var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},x.pairs=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){var t={},n=x.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return x})}).call(this),function(e,t){if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.push,u=s.slice,a=s.splice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var f=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!c(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){var i,s,o,u,a,f,l,h;if(!this._events||!c(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;u=e?[e]:n.keys(this._events);for(a=0,f=u.length;a<f;a++){e=u[a];if(o=this._events[e]){this._events[e]=i=[];if(t||r)for(l=0,h=o.length;l<h;l++)s=o[l],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&i.push(s);i.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=u.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&h(n,t),r&&h(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){var s=n.split(l);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},h=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},p={listenTo:"on",listenToOnce:"once"};n.each(p,function(e,t){f[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),f.bind=f.on,f.unbind=f.off,n.extend(t,f);var d=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;if(!a){u.length&&(this._pending=r);for(var h=0,p=u.length;h<p;h++)this.trigger("change:"+u[h],this,c[u[h]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},I(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},I(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;I(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||F();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];n.each(v,function(e){d.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};n.extend(m.prototype,f,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,y))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});var i,s,o,u;for(i=0,s=e.length;i<s;i++){u=e[i]=this.get(e[i]);if(!u)continue;delete this._byId[u.id],delete this._byId[u.cid],o=this.indexOf(u),this.models.splice(o,1),this.length--,t.silent||(t.index=o,u.trigger("remove",u,this,t)),this._removeReference(u,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:n.clone(e);var i,s,o,u,a,f,l,c=t.at,h=this.model,p=this.comparator&&c==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!p&&w&&S?[]:!1;for(i=0,s=e.length;i<s;i++){a=e[i]||{},a instanceof d?o=u=a:o=a[h.prototype.idAttribute||"id"];if(f=this.get(o))S&&(b[f.cid]=!0),E&&(a=a===u?u.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),p&&!l&&f.hasChanged(v)&&(l=!0)),e[i]=f;else if(w){u=e[i]=this._prepareModel(a,t);if(!u)continue;m.push(u),this._addReference(u,t)}u=f||u,x&&(u.isNew()||!b[u.id])&&x.push(u),b[u.id]=!0}if(S){for(i=0,s=this.length;i<s;++i)b[(u=this.models[i]).cid]||y.push(u);y.length&&this.remove(y,t)}if(m.length||x&&x.length){p&&(l=!0),this.length+=m.length;if(c!=null)for(i=0,s=m.length;i<s;i++)this.models.splice(c+i,0,m[i]);else{x&&(this.models.length=0);var T=x||m;for(i=0,s=T.length;i<s;i++)this.models.push(T[i])}}l&&this.sort({silent:!0});if(!t.silent){for(i=0,s=m.length;i<s;i++)(u=m[i]).trigger("add",u,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return u.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(b,function(e){m.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy","indexBy"];n.each(w,function(e){m.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var E=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(E.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)continue;var i=t.match(S),s=i[1],o=i[2];r=n.bind(r,this),s+=".delegateEvents"+this.cid,o===""?this.$el.on(s,r):this.$el.on(s,o,r)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var r=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(r,!1)}else this.setElement(n.result(this,"el"),!1)}}),t.sync=function(e,r,i){var s=N[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||F()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&T&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,a,i),a};var T=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,A=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,f,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(k,"(?:$1)?").replace(L,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/msie [\w.]+/,H=/\/$/,B=/#.*$/;M.started=!1,n.extend(M.prototype,f,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(H,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(_,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(D,"/");if(s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var u=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&u.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!M.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(B,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new M;var j=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};d.extend=m.extend=C.extend=E.extend=M.extend=j;var F=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t}),function(e){function tt(e,t,n){switch(arguments.length){case 2:return e!=null?e:t;case 3:return e!=null?e:t!=null?t:n;default:throw new Error("Implement me")}}function nt(e,t){return o.call(e,t)}function rt(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function it(e){t.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+e)}function st(e,t){var n=!0;return ht(function(){return n&&(it(e),n=!1),t.apply(this,arguments)},t)}function ot(e,t){Z[e]||(it(t),Z[e]=!0)}function ut(e,t){return function(n){return vt(e.call(this,n),t)}}function at(e,t){return function(n){return this.localeData().ordinal(e.call(this,n),t)}}function ft(){}function lt(e,t){t!==!1&&Mt(e),pt(this,e),this._d=new Date(+e._d)}function ct(e){var n=Tt(e),r=n.year||0,i=n.quarter||0,s=n.month||0,o=n.week||0,u=n.day||0,a=n.hour||0,f=n.minute||0,l=n.second||0,c=n.millisecond||0;this._milliseconds=+c+l*1e3+f*6e4+a*36e5,this._days=+u+o*7,this._months=+s+i*3+r*12,this._data={},this._locale=t.localeData(),this._bubble()}function ht(e,t){for(var n in t)nt(t,n)&&(e[n]=t[n]);return nt(t,"toString")&&(e.toString=t.toString),nt(t,"valueOf")&&(e.valueOf=t.valueOf),e}function pt(e,t){var n,r,i;typeof t._isAMomentObject!="undefined"&&(e._isAMomentObject=t._isAMomentObject),typeof t._i!="undefined"&&(e._i=t._i),typeof t._f!="undefined"&&(e._f=t._f),typeof t._l!="undefined"&&(e._l=t._l),typeof t._strict!="undefined"&&(e._strict=t._strict),typeof t._tzm!="undefined"&&(e._tzm=t._tzm),typeof t._isUTC!="undefined"&&(e._isUTC=t._isUTC),typeof t._offset!="undefined"&&(e._offset=t._offset),typeof t._pf!="undefined"&&(e._pf=t._pf),typeof t._locale!="undefined"&&(e._locale=t._locale);if(m.length>0)for(n in m)r=m[n],i=t[r],typeof i!="undefined"&&(e[r]=i);return e}function dt(e){return e<0?Math.ceil(e):Math.floor(e)}function vt(e,t,n){var r=""+Math.abs(e),i=e>=0;while(r.length<t)r="0"+r;return(i?n?"+":"":"-")+r}function mt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t- +e.clone().add(n.months,"M"),n}function gt(e,t){var n;return t=Bt(t,e),e.isBefore(t)?n=mt(e,t):(n=mt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function yt(e,n){return function(r,i){var s,o;return i!==null&&!isNaN(+i)&&(ot(n,"moment()."+n+"(period, number) is deprecated. Please use moment()."+n+"(number, period)."),o=r,r=i,i=o),r=typeof r=="string"?+r:r,s=t.duration(r,i),bt(this,s,e),this}}function bt(e,n,r,i){var s=n._milliseconds,o=n._days,u=n._months;i=i==null?!0:i,s&&e._d.setTime(+e._d+s*r),o&&dn(e,"Date",pn(e,"Date")+o*r),u&&hn(e,pn(e,"Month")+u*r),i&&t.updateOffset(e,o||u)}function wt(e){return Object.prototype.toString.call(e)==="[object Array]"}function Et(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function St(e,t,n){var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0,o;for(o=0;o<r;o++)(n&&e[o]!==t[o]||!n&&Ct(e[o])!==Ct(t[o]))&&s++;return s+i}function xt(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=V[e]||$[t]||t}return e}function Tt(e){var t={},n,r;for(r in e)nt(e,r)&&(n=xt(r),n&&(t[n]=e[r]));return t}function Nt(n){var r,i;if(n.indexOf("week")===0)r=7,i="day";else{if(n.indexOf("month")!==0)return;r=12,i="month"}t[n]=function(s,o){var u,a,f=t._locale[n],l=[];typeof s=="number"&&(o=s,s=e),a=function(e){var n=t().utc().set(i,e);return f.call(t._locale,n,s||"")};if(o!=null)return a(o);for(u=0;u<r;u++)l.push(a(u));return l}}function Ct(e){var t=+e,n=0;return t!==0&&isFinite(t)&&(t>=0?n=Math.floor(t):n=Math.ceil(t)),n}function kt(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function Lt(e,n,r){return an(t([e,11,31+n-r]),n,r).week}function At(e){return Ot(e)?366:365}function Ot(e){return e%4===0&&e%100!==0||e%400===0}function Mt(e){var t;e._a&&e._pf.overflow===-2&&(t=e._a[f]<0||e._a[f]>11?f:e._a[l]<1||e._a[l]>kt(e._a[a],e._a[f])?l:e._a[c]<0||e._a[c]>24||e._a[c]===24&&(e._a[h]!==0||e._a[p]!==0||e._a[d]!==0)?c:e._a[h]<0||e._a[h]>59?h:e._a[p]<0||e._a[p]>59?p:e._a[d]<0||e._a[d]>999?d:-1,e._pf._overflowDayOfYear&&(t<a||t>l)&&(t=l),e._pf.overflow=t)}function _t(t){return t._isValid==null&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&t._pf.charsLeftOver===0&&t._pf.unusedTokens.length===0&&t._pf.bigHour===e)),t._isValid}function Dt(e){return e?e.toLowerCase().replace("_","-"):e}function Pt(e){var t=0,n,r,i,s;while(t<e.length){s=Dt(e[t]).split("-"),n=s.length,r=Dt(e[t+1]),r=r?r.split("-"):null;while(n>0){i=Ht(s.slice(0,n).join("-"));if(i)return i;if(r&&r.length>=n&&St(s,r,!0)>=n-1)break;n--}t++}return null}function Ht(e){var n=null;if(!v[e]&&g)try{n=t.locale(),require("./locale/"+e),t.locale(n)}catch(r){}return v[e]}function Bt(e,n){var r,i;return n._isUTC?(r=n.clone(),i=(t.isMoment(e)||Et(e)?+e:+t(e))- +r,r._d.setTime(+r._d+i),t.updateOffset(r,!1),r):t(e).local()}function jt(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function Ft(e){var t=e.match(E),n,r;for(n=0,r=t.length;n<r;n++)Y[t[n]]?t[n]=Y[t[n]]:t[n]=jt(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=t[n]instanceof Function?t[n].call(i,e):t[n];return s}}function It(e,t){return e.isValid()?(t=qt(t,e.localeData()),J[t]||(J[t]=Ft(t)),J[t](e)):e.localeData().invalidDate()}function qt(e,t){function r(e){return t.longDateFormat(e)||e}var n=5;S.lastIndex=0;while(n>=0&&S.test(e))e=e.replace(S,r),S.lastIndex=0,n-=1;return e}function Rt(e,t){var n,r=t._strict;switch(e){case"Q":return D;case"DDDD":return H;case"YYYY":case"GGGG":case"gggg":return r?B:N;case"Y":case"G":case"g":return F;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return r?j:C;case"S":if(r)return D;case"SS":if(r)return P;case"SSS":if(r)return H;case"DDD":return T;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return L;case"a":case"A":return t._locale._meridiemParse;case"x":return M;case"X":return _;case"Z":case"ZZ":return A;case"T":return O;case"SSSS":return k;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return r?P:x;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return x;case"Do":return r?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:return n=new RegExp(Qt(Kt(e.replace("\\","")),"i")),n}}function Ut(e){e=e||"";var t=e.match(A)||[],n=t[t.length-1]||[],r=(n+"").match(z)||["-",0,0],i=+(r[1]*60)+Ct(r[2]);return r[0]==="+"?-i:i}function zt(e,n,r){var i,s=r._a;switch(e){case"Q":n!=null&&(s[f]=(Ct(n)-1)*3);break;case"M":case"MM":n!=null&&(s[f]=Ct(n)-1);break;case"MMM":case"MMMM":i=r._locale.monthsParse(n,e,r._strict),i!=null?s[f]=i:r._pf.invalidMonth=n;break;case"D":case"DD":n!=null&&(s[l]=Ct(n));break;case"Do":n!=null&&(s[l]=Ct(parseInt(n.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":n!=null&&(r._dayOfYear=Ct(n));break;case"YY":s[a]=t.parseTwoDigitYear(n);break;case"YYYY":case"YYYYY":case"YYYYYY":s[a]=Ct(n);break;case"a":case"A":r._isPm=r._locale.isPM(n);break;case"h":case"hh":r._pf.bigHour=!0;case"H":case"HH":s[c]=Ct(n);break;case"m":case"mm":s[h]=Ct(n);break;case"s":case"ss":s[p]=Ct(n);break;case"S":case"SS":case"SSS":case"SSSS":s[d]=Ct(("0."+n)*1e3);break;case"x":r._d=new Date(Ct(n));break;case"X":r._d=new Date(parseFloat(n)*1e3);break;case"Z":case"ZZ":r._useUTC=!0,r._tzm=Ut(n);break;case"dd":case"ddd":case"dddd":i=r._locale.weekdaysParse(n),i!=null?(r._w=r._w||{},r._w.d=i):r._pf.invalidWeekday=n;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),n&&(r._w=r._w||{},r._w[e]=Ct(n));break;case"gg":case"GG":r._w=r._w||{},r._w[e]=t.parseTwoDigitYear(n)}}function Wt(e){var n,r,i,s,o,u,f;n=e._w,n.GG!=null||n.W!=null||n.E!=null?(o=1,u=4,r=tt(n.GG,e._a[a],an(t(),1,4).year),i=tt(n.W,1),s=tt(n.E,1)):(o=e._locale._week.dow,u=e._locale._week.doy,r=tt(n.gg,e._a[a],an(t(),o,u).year),i=tt(n.w,1),n.d!=null?(s=n.d,s<o&&++i):n.e!=null?s=n.e+o:s=o),f=fn(r,i,s,u,o),e._a[a]=f.year,e._dayOfYear=f.dayOfYear}function Xt(e){var t,n,r=[],i,s;if(e._d)return;i=$t(e),e._w&&e._a[l]==null&&e._a[f]==null&&Wt(e),e._dayOfYear&&(s=tt(e._a[a],i[a]),e._dayOfYear>At(s)&&(e._pf._overflowDayOfYear=!0),n=rn(s,0,e._dayOfYear),e._a[f]=n.getUTCMonth(),e._a[l]=n.getUTCDate());for(t=0;t<3&&e._a[t]==null;++t)e._a[t]=r[t]=i[t];for(;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[c]===24&&e._a[h]===0&&e._a[p]===0&&e._a[d]===0&&(e._nextDay=!0,e._a[c]=0),e._d=(e._useUTC?rn:nn).apply(null,r),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm),e._nextDay&&(e._a[c]=24)}function Vt(e){var t;if(e._d)return;t=Tt(e._i),e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],Xt(e)}function $t(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Jt(n){if(n._f===t.ISO_8601){Yt(n);return}n._a=[],n._pf.empty=!0;var r=""+n._i,i,s,o,u,a,f=r.length,l=0;o=qt(n._f,n._locale).match(E)||[];for(i=0;i<o.length;i++)u=o[i],s=(r.match(Rt(u,n))||[])[0],s&&(a=r.substr(0,r.indexOf(s)),a.length>0&&n._pf.unusedInput.push(a),r=r.slice(r.indexOf(s)+s.length),l+=s.length),Y[u]?(s?n._pf.empty=!1:n._pf.unusedTokens.push(u),zt(u,s,n)):n._strict&&!s&&n._pf.unusedTokens.push(u);n._pf.charsLeftOver=f-l,r.length>0&&n._pf.unusedInput.push(r),n._pf.bigHour===!0&&n._a[c]<=12&&(n._pf.bigHour=e),n._isPm&&n._a[c]<12&&(n._a[c]+=12),n._isPm===!1&&n._a[c]===12&&(n._a[c]=0),Xt(n),Mt(n)}function Kt(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})}function Qt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Gt(e){var t,n,r,i,s;if(e._f.length===0){e._pf.invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){s=0,t=pt({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._pf=rt(),t._f=e._f[i],Jt(t);if(!_t(t))continue;s+=t._pf.charsLeftOver,s+=t._pf.unusedTokens.length*10,t._pf.score=s;if(r==null||s<r)r=s,n=t}ht(e,n||t)}function Yt(e){var t,n,r=e._i,i=I.exec(r);if(i){e._pf.iso=!0;for(t=0,n=R.length;t<n;t++)if(R[t][1].exec(r)){e._f=R[t][0]+(i[6]||" ");break}for(t=0,n=U.length;t<n;t++)if(U[t][1].exec(r)){e._f+=U[t][0];break}r.match(A)&&(e._f+="Z"),Jt(e)}else e._isValid=!1}function Zt(e){Yt(e),e._isValid===!1&&(delete e._isValid,t.createFromInputFallback(e))}function en(e,t){var n=[],r;for(r=0;r<e.length;++r)n.push(t(e[r],r));return n}function tn(n){var r=n._i,i;r===e?n._d=new Date:Et(r)?n._d=new Date(+r):(i=y.exec(r))!==null?n._d=new Date(+i[1]):typeof r=="string"?Zt(n):wt(r)?(n._a=en(r.slice(0),function(e){return parseInt(e,10)}),Xt(n)):typeof r=="object"?Vt(n):typeof r=="number"?n._d=new Date(r):t.createFromInputFallback(n)}function nn(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return e<1970&&u.setFullYear(e),u}function rn(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function sn(e,t){if(typeof e=="string")if(!isNaN(e))e=parseInt(e,10);else{e=t.weekdaysParse(e);if(typeof e!="number")return null}return e}function on(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function un(e,n,r){var i=t.duration(e).abs(),o=s(i.as("s")),u=s(i.as("m")),a=s(i.as("h")),f=s(i.as("d")),l=s(i.as("M")),c=s(i.as("y")),h=o<K.s&&["s",o]||u===1&&["m"]||u<K.m&&["mm",u]||a===1&&["h"]||a<K.h&&["hh",a]||f===1&&["d"]||f<K.d&&["dd",f]||l===1&&["M"]||l<K.M&&["MM",l]||c===1&&["y"]||["yy",c];return h[2]=n,h[3]=+e>0,h[4]=r,on.apply({},h)}function an(e,n,r){var i=r-n,s=r-e.day(),o;return s>i&&(s-=7),s<i-7&&(s+=7),o=t(e).add(s,"d"),{week:Math.ceil(o.dayOfYear()/7),year:o.year()}}function fn(e,t,n,r,i){var s=rn(e,0,1).getUTCDay(),o,u;return s=s===0?7:s,n=n!=null?n:i,o=i-s+(s>r?7:0)-(s<i?7:0),u=7*(t-1)+(n-i)+o+1,{year:u>0?e:e-1,dayOfYear:u>0?u:At(e-1)+u}}function ln(n){var r=n._i,i=n._f,s;return n._locale=n._locale||t.localeData(n._l),r===null||i===e&&r===""?t.invalid({nullInput:!0}):(typeof r=="string"&&(n._i=r=n._locale.preparse(r)),t.isMoment(r)?new lt(r,!0):(i?wt(i)?Gt(n):Jt(n):tn(n),s=new lt(n),s._nextDay&&(s.add(1,"d"),s._nextDay=e),s))}function cn(e,n){var r,i;n.length===1&&wt(n[0])&&(n=n[0]);if(!n.length)return t();r=n[0];for(i=1;i<n.length;++i)n[i][e](r)&&(r=n[i]);return r}function hn(e,t){var n;if(typeof t=="string"){t=e.localeData().monthsParse(t);if(typeof t!="number")return e}return n=Math.min(e.date(),kt(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function pn(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function dn(e,t,n){return t==="Month"?hn(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function vn(e,n){return function(r){return r!=null?(dn(this,e,r),t.updateOffset(this,n),this):pn(this,e)}}function mn(e){return e*400/146097}function gn(e){return e*146097/400}function yn(e){t.duration.fn[e]=function(){return this._data[e]}}function bn(e){if(typeof ender!="undefined")return;i=r.moment,e?r.moment=st("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",t):r.moment=t}var t,n="2.8.4",r=typeof global!="undefined"?global:this,i,s=Math.round,o=Object.prototype.hasOwnProperty,u,a=0,f=1,l=2,c=3,h=4,p=5,d=6,v={},m=[],g=typeof module!="undefined"&&module&&module.exports,y=/^\/?Date\((\-?\d+)/i,b=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,w=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,E=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,S=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,x=/\d\d?/,T=/\d{1,3}/,N=/\d{1,4}/,C=/[+\-]?\d{1,6}/,k=/\d+/,L=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,A=/Z|[\+\-]\d\d:?\d\d/gi,O=/T/i,M=/[\+\-]?\d+/,_=/[\+\-]?\d+(\.\d{1,3})?/,D=/\d/,P=/\d\d/,H=/\d{3}/,B=/\d{4}/,j=/[+-]?\d{6}/,F=/[+-]?\d+/,I=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,q="YYYY-MM-DDTHH:mm:ssZ",R=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],U=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],z=/([\+\-]|\d\d)/gi,W="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),X={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},V={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},$={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},J={},K={s:45,m:45,h:22,d:26,M:11},Q="DDD w W M D d".split(" "),G="M D H h m s w W".split(" "),Y={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return vt(this.year()%100,2)},YYYY:function(){return vt(this.year(),4)},YYYYY:function(){return vt(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+vt(Math.abs(e),6)},gg:function(){return vt(this.weekYear()%100,2)},gggg:function(){return vt(this.weekYear(),4)},ggggg:function(){return vt(this.weekYear(),5)},GG:function(){return vt(this.isoWeekYear()%100,2)},GGGG:function(){return vt(this.isoWeekYear(),4)},GGGGG:function(){return vt(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return Ct(this.milliseconds()/100)},SS:function(){return vt(Ct(this.milliseconds()/10),2)},SSS:function(){return vt(this.milliseconds(),3)},SSSS:function(){return vt(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+vt(Ct(e/60),2)+":"+vt(Ct(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+vt(Ct(e/60),2)+vt(Ct(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Z={},et=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];while(Q.length)u=Q.pop(),Y[u+"o"]=at(Y[u],u);while(G.length)u=G.pop(),Y[u+u]=ut(Y[u],2);Y.DDDD=ut(Y.DDD,3),ht(ft.prototype,{set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e,n,r){var i,s,o;this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(i=0;i<12;i++){s=t.utc([2e3,i]),r&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!r&&!this._monthsParse[i]&&(o="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i"));if(r&&n==="MMMM"&&this._longMonthsParse[i].test(e))return i;if(r&&n==="MMM"&&this._shortMonthsParse[i].test(e))return i;if(!r&&this._monthsParse[i].test(e))return i}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var n,r,i;this._weekdaysParse||(this._weekdaysParse=[]);for(n=0;n<7;n++){this._weekdaysParse[n]||(r=t([2e3,1]).day(n),i="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i"));if(this._weekdaysParse[n].test(e))return n}},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return(e+"").toLowerCase().charAt(0)==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t,n){var r=this._calendar[e];return typeof r=="function"?r.apply(t,[n]):r},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(e){return e},postformat:function(e){return e},week:function(e){return an(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),t=function(t,n,r,i){var s;return typeof r=="boolean"&&(i=r,r=e),s={},s._isAMomentObject=!0,s._i=t,s._f=n,s._l=r,s._strict=i,s._isUTC=!1,s._pf=rt(),ln(s)},t.suppressDeprecationWarnings=!1,t.createFromInputFallback=st("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.min=function(){var e=[].slice.call(arguments,0);return cn("isBefore",e)},t.max=function(){var e=[].slice.call(arguments,0);return cn("isAfter",e)},t.utc=function(t,n,r,i){var s;return typeof r=="boolean"&&(i=r,r=e),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=r,s._i=t,s._f=n,s._strict=i,s._pf=rt(),ln(s).utc()},t.unix=function(e){return t(e*1e3)},t.duration=function(e,n){var r=e,i=null,s,o,u,a;return t.isDuration(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:typeof e=="number"?(r={},n?r[n]=e:r.milliseconds=e):(i=b.exec(e))?(s=i[1]==="-"?-1:1,r={y:0,d:Ct(i[l])*s,h:Ct(i[c])*s,m:Ct(i[h])*s,s:Ct(i[p])*s,ms:Ct(i[d])*s}):(i=w.exec(e))?(s=i[1]==="-"?-1:1,u=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*s},r={y:u(i[2]),M:u(i[3]),d:u(i[4]),h:u(i[5]),m:u(i[6]),s:u(i[7]),w:u(i[8])}):typeof r=="object"&&("from"in r||"to"in r)&&(a=gt(t(r.from),t(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),o=new ct(r),t.isDuration(e)&&nt(e,"_locale")&&(o._locale=e._locale),o},t.version=n,t.defaultFormat=q,t.ISO_8601=function(){},t.momentProperties=m,t.updateOffset=function(){},t.relativeTimeThreshold=function(t,n){return K[t]===e?!1:n===e?K[t]:(K[t]=n,!0)},t.lang=st("moment.lang is deprecated. Use moment.locale instead.",function(e,n){return t.locale(e,n)}),t.locale=function(e,n){var r;return e&&(typeof n!="undefined"?r=t.defineLocale(e,n):r=t.localeData(e),r&&(t.duration._locale=t._locale=r)),t._locale._abbr},t.defineLocale=function(e,n){return n!==null?(n.abbr=e,v[e]||(v[e]=new ft),v[e].set(n),t.locale(e),v[e]):(delete v[e],null)},t.langData=st("moment.langData is deprecated. Use moment.localeData instead.",function(e){return t.localeData(e)}),t.localeData=function(e){var n;e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr);if(!e)return t._locale;if(!wt(e)){n=Ht(e);if(n)return n;e=[e]}return Pt(e)},t.isMoment=function(e){return e instanceof lt||e!=null&&nt(e,"_isAMomentObject")},t.isDuration=function(e){return e instanceof ct};for(u=et.length-1;u>=0;--u)Nt(et[u]);t.normalizeUnits=function(e){return xt(e)},t.invalid=function(e){var n=t.utc(NaN);return e!=null?ht(n._pf,e):n._pf.userInvalidated=!0,n},t.parseZone=function(){return t.apply(null,arguments).parseZone()},t.parseTwoDigitYear=function(e){return Ct(e)+(Ct(e)>68?1900:2e3)},ht(t.fn=lt.prototype,{clone:function(){return t(this)},valueOf:function(){return+this._d+(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=t(this).utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():It(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):It(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return _t(this)},isDSTShifted:function(){return this._a?this.isValid()&&St(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray())>0:!1},parsingFlags:function(){return ht({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._dateTzOffset(),"m")),this},format:function(e){var n=It(this,e||t.defaultFormat);return this.localeData().postformat(n)},add:yt(1,"add"),subtract:yt(-1,"subtract"),diff:function(e,n,r){var i=Bt(e,this),s=(this.zone()-i.zone())*6e4,o,u,a;return n=xt(n),n==="year"||n==="month"?(o=(this.daysInMonth()+i.daysInMonth())*432e5,u=(this.year()-i.year())*12+(this.month()-i.month()),a=this-t(this).startOf("month")-(i-t(i).startOf("month")),a-=(this.zone()-t(this).startOf("month").zone()-(i.zone()-t(i).startOf("month").zone()))*6e4,u+=a/o,n==="year"&&(u/=12)):(o=this-i,u=n==="second"?o/1e3:n==="minute"?o/6e4:n==="hour"?o/36e5:n==="day"?(o-s)/864e5:n==="week"?(o-s)/6048e5:o),r?u:dt(u)},from:function(e,n){return t.duration({to:this,from:e}).locale(this.locale()).humanize(!n)},fromNow:function(e){return this.from(t(),e)},calendar:function(e){var n=e||t(),r=Bt(n,this).startOf("day"),i=this.diff(r,"days",!0),s=i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(s,this,t(n)))},isLeapYear:function(){return Ot(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=sn(e,this.localeData()),this.add(e-t,"d")):t},month:vn("Month",!0),startOf:function(e){e=xt(e);switch(e){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"?this.weekday(0):e==="isoWeek"&&this.isoWeekday(1),e==="quarter"&&this.month(Math.floor(this.month()/3)*3),this},endOf:function(t){return t=xt(t),t===e||t==="millisecond"?this:this.startOf(t).add(1,t==="isoWeek"?"week":t).subtract(1,"ms")},isAfter:function(e,n){var r;return n=xt(typeof n!="undefined"?n:"millisecond"),n==="millisecond"?(e=t.isMoment(e)?e:t(e),+this>+e):(r=t.isMoment(e)?+e:+t(e),r<+this.clone().startOf(n))},isBefore:function(e,n){var r;return n=xt(typeof n!="undefined"?n:"millisecond"),n==="millisecond"?(e=t.isMoment(e)?e:t(e),+this<+e):(r=t.isMoment(e)?+e:+t(e),+this.clone().endOf(n)<r)},isSame:function(e,n){var r;return n=xt(n||"millisecond"),n==="millisecond"?(e=t.isMoment(e)?e:t(e),+this===+e):(r=+t(e),+this.clone().startOf(n)<=r&&r<=+this.clone().endOf(n))},min:st("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=t.apply(null,arguments),e<this?this:e}),max:st("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=t.apply(null,arguments),e>this?this:e}),zone:function(e,n){var r=this._offset||0,i;return e==null?this._isUTC?r:this._dateTzOffset():(typeof e=="string"&&(e=Ut(e)),Math.abs(e)<16&&(e*=60),!this._isUTC&&n&&(i=this._dateTzOffset()),this._offset=e,this._isUTC=!0,i!=null&&this.subtract(i,"m"),r!==e&&(!n||this._changeInProgress?bt(this,t.duration(r-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):typeof this._i=="string"&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e?e=t(e).zone():e=0,(this.zone()-e)%60===0},daysInMonth:function(){return kt(this.year(),this.month())},dayOfYear:function(e){var n=s((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return e==null?n:this.add(e-n,"d")},quarter:function(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)},weekYear:function(e){var t=an(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return e==null?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=an(this,1,4).year;return e==null?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")},isoWeek:function(e){var t=an(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")},isoWeekday:function(e){return e==null?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return Lt(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return Lt(this.year(),e.dow,e.doy)},get:function(e){return e=xt(e),this[e]()},set:function(e,t){return e=xt(e),typeof this[e]=="function"&&this[e](t),this},locale:function(n){var r;return n===e?this._locale._abbr:(r=t.localeData(n),r!=null&&(this._locale=r),this)},lang:st("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===e?this.localeData():this.locale(t)}),localeData:function(){return this._locale},_dateTzOffset:function(){return Math.round(this._d.getTimezoneOffset()/15)*15}}),t.fn.millisecond=t.fn.milliseconds=vn("Milliseconds",!1),t.fn.second=t.fn.seconds=vn("Seconds",!1),t.fn.minute=t.fn.minutes=vn("Minutes",!1),t.fn.hour=t.fn.hours=vn("Hours",!0),t.fn.date=vn("Date",!0),t.fn.dates=st("dates accessor is deprecated. Use date instead.",vn("Date",!0)),t.fn.year=vn("FullYear",!0),t.fn.years=st("years accessor is deprecated. Use year instead.",vn("FullYear",!0)),t.fn.days=t.fn.day,t.fn.months=t.fn.month,t.fn.weeks=t.fn.week,t.fn.isoWeeks=t.fn.isoWeek,t.fn.quarters=t.fn.quarter,t.fn.toJSON=t.fn.toISOString,ht(t.duration.fn=ct.prototype,{_bubble:function(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,s,o,u=0;r.milliseconds=e%1e3,i=dt(e/1e3),r.seconds=i%60,s=dt(i/60),r.minutes=s%60,o=dt(s/60),r.hours=o%24,t+=dt(o/24),u=dt(mn(t)),t-=dt(gn(u)),n+=dt(t/30),t%=30,u+=dt(n/12),n%=12,r.days=t,r.months=n,r.years=u},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return dt(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+Ct(this._months/12)*31536e6},humanize:function(e){var t=un(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(e,n){var r=t.duration(e,n);return this._milliseconds+=r._milliseconds,this._days+=r._days,this._months+=r._months,this._bubble(),this},subtract:function(e,n){var r=t.duration(e,n);return this._milliseconds-=r._milliseconds,this._days-=r._days,this._months-=r._months,this._bubble(),this},get:function(e){return e=xt(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;e=xt(e);if(e==="month"||e==="year")return t=this._days+this._milliseconds/864e5,n=this._months+mn(t)*12,e==="month"?n:n/12;t=this._days+Math.round(gn(this._months/12));switch(e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return t*24+this._milliseconds/36e5;case"minute":return t*24*60+this._milliseconds/6e4;case"second":return t*24*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(t*24*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:t.fn.lang,locale:t.fn.locale,toIsoString:st("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),r=Math.abs(this.hours()),i=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(r||i||s?"T":"")+(r?r+"H":"")+(i?i+"M":"")+(s?s+"S":""):"P0D"},localeData:function(){return this._locale}}),t.duration.fn.toString=t.duration.fn.toISOString;for(u in X)nt(X,u)&&yn(u.toLowerCase());t.duration.fn.asMilliseconds=function(){return this.as("ms")},t.duration.fn.asSeconds=function(){return this.as("s")},t.duration.fn.asMinutes=function(){return this.as("m")},t.duration.fn.asHours=function(){return this.as("h")},t.duration.fn.asDays=function(){return this.as("d")},t.duration.fn.asWeeks=function(){return this.as("weeks")},t.duration.fn.asMonths=function(){return this.as("M")},t.duration.fn.asYears=function(){return this.as("y")},t.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=Ct(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),g?module.exports=t:typeof define=="function"&&define.amd?(define("moment",["require","exports","module"],function(e,n,s){return s.config&&s.config()&&s.config().noGlobal===!0&&(r.moment=i),t}),bn(!0)):bn()}.call(this),define("view/search",["jquery","underscore","backbone"],function(e,t,n){return n.View.extend({el:e("#search"),initialize:function(){this.render()},render:function(){this.$el.append('                <form id="search-form" class="search-form">                  <input type="text" class="search-input" id="search-input" placeholder="在此输入用户名，猛敲回车">                  <button type="submit" class="search-submit">                    <i class="search-submit-ico">&#xe606;</i>                    <span class="ui-hide-text">搜索</span>                  </button>                </form>            ')},events:{"submit form#search-form":"switchUser"},switchUser:function(t){t.preventDefault(),n.history.navigate("#user/"+e("#search-input").val(),{trigger:!0})}})}),define("controller/defaultTime",["moment"],function(e){var t=new Date,n=t.getDay()==0?7:t.getDay(),r=e().subtract(n-1,"days").format().substr(0,10),i=e().subtract(-(7-n),"days").format().substr(0,10);return{start:r,end:i}}),define("view/group",["jquery","underscore","backbone","controller/defaultTime","jqueryUI"],function(e,t,n,r){var i=n.View.extend({tagName:"tr",initialize:function(){this.listenTo(this.model,"destroy",this.destroy)},destroy:function(){this.remove()},renderViewMode:function(){e(this.el).html('<td class="group-name ui-center"><a href="#archive/group/'+this.model.get("name")+"/"+r.start+"/"+r.end+'">'+this.model.get("name")+'</a></td><td class="ui-center group-members">'+this.model.get("members")+'</td><td class="ui-center group-mail">'+this.model.get("mail")+'</td><td class="ui-center group-command"><button class="ui-button-primary ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only edit">编辑</button>&nbsp;<button class="ui-button-error ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only delete">删除</a></button>')},renderEditMode:function(){e(this.el).html('<td class="group-name"><input type="text" class="ui-control ui-control-line ui-control-full ui-center group-name-text" value="'+this.model.get("name")+'" /></td><td class="group-members"><textarea class="ui-control ui-control-box ui-control-full group-members-textarea">'+this.model.get("members")+'</textarea></td><td class="group-mail"><input type="text" class="ui-control ui-control-line ui-control-full ui-center group-mail-text" value="'+this.model.get("mail")+'" /></td><td class="group-command ui-center"><button class="ui-button-success ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only save">保存</a></button>&nbsp;<button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only cancel">取消</button></td>')},renderCallback:"renderViewMode",render:function(){return this[this.renderCallback](),this},events:{"click .edit":"edit","click .save":"save","click .cancel":"cancel","click .delete":"delete"},edit:function(e){e.preventDefault(),this.renderCallback="renderEditMode",this.render()},save:function(t){t.preventDefault(),this.model.set({name:e(this.el).find(".group-name-text").val(),members:e(this.el).find(".group-members-textarea").val(),mail:e(this.el).find(".group-mail-text").val()}),this.renderCallback="renderViewMode",this.render(),this.model.save()},"delete":function(e){e.preventDefault();var t=confirm("您确定要删除么？");if(!t)return;this.model.destroy({success:function(e,t){}}),this.remove()},cancel:function(e){e.preventDefault(),this.renderCallback="renderViewMode",this.render()}}),s=n.View.extend({tagName:"table",className:"ui-table ui-mt group-table",initialize:function(){this.listenTo(this.collection,"add",this.render,this),this.listenTo(this.collection,"change",this.change,this)},change:function(e){},render:function(){return e(this.el).empty(),e(this.el).append(t.map(["组名","成员","邮件抄送地址","命令"],function(e,t){return"<th>"+e+"</th>"})),t.each(this.collection.models,function(t,n,r){e(this.el).append((new i({model:t})).render().el)},this),this}}),o=n.View.extend({tagName:"div",className:"group-add",render:function(){var t='<div id="group-dialog" title="新建用户组" style="display:none;"><form method="post" class="ui-form group-form" id="group-form"><table class="group-form-table"><tr><td class="ui-tag"><label class="group-form-label" for="group-title">组名：</label></td><td><input type="text" name="title" id="group-title" class="ui-control ui-control-box ui-control-normal" placeholder="用户组名称"></td></tr><tr><td class="ui-tag"><label class="group-form-label" for="group-members">成员：</label></td><td><textarea name="members" id="group-members" class="ui-control ui-control-box ui-control-normal" placeholder="用户名用英文状态逗号分割"></textarea></td></tr><tr><td class="ui-tag"><label class="group-form-label" for="group-mail">邮件账号：</label></td><td><input type="text" name="mail" id="group-mail" class="ui-control ui-control-box ui-control-normal" placeholder="抄送群组邮件名"></td></table></form></div><div class="group-list" id="group-main"></div><a href="#" class="group-add-command ui-iconfont" id="add">&#xe605;</a>';return e(this.el).html(t),this}});return n.View.extend({tagName:"div",className:"group",initialize:function(){},render:function(){return e(this.el).html((new o({collection:this.collection})).render().el),e(this.el).append((new s({collection:this.collection})).render().el),this},events:{"click #add":"addGroup","submit #group-form":"submitForm"},submitForm:function(t){t.preventDefault(),e(".ui-dialog-buttonset button:eq(0)").trigger("click")},addGroup:function(t){t.preventDefault();var n=this;e("#group-dialog").dialog({modal:!0,position:{my:"center top+40",at:"center top",of:window},width:360,open:function(t,n){e(this).parent().focus()},buttons:[{text:"保存",click:function(t){var r={name:e("#group-title").val(),members:e("#group-members").val(),mail:e("#group-mail").val()};n.collection.create(r,{success:function(){console.log("添加成功！"),n.collection.fetch({success:function(){console.log("sucess")}})}}),e(this).dialog("close")}},{text:"取消",click:function(t){t.preventDefault(),e(this).dialog("close")}}]})}})}),define("view/mail",["jquery","underscore","backbone","moment","controller/defaultTime","jqueryUI"],function(e,t,n,r,i){return n.View.extend({tagName:"div",className:"send-mail",initialize:function(){},render:function(){var t=localStorage.getItem("mailAddress")?localStorage.getItem("mailAddress"):"",n=localStorage.getItem("groupName")?localStorage.getItem("groupName"):"";return e(this.el).html('                <form id="send-mail-form" class="ui-form send-mail-form">                    <table class="send-mail-table">                        <tr>                            <td class="ui-tag">类型：</td>                            <td>                                <select name="type" id="type">                                    <option value="1">团队</option>                                    <option value="2">个人</option>                                </select>                            </td>                        </tr>                        <tr id="name-content">                            <td class="ui-tag">用户组：</td>                            <td>                                <input class="ui-control ui-control-box ui-control-full" type="input" id="groupName" name="groupName" value="'+n+'" />                            </td>                        </tr>                        <tr id="address-content" style="display:none;">                            <td class="ui-tag">发送地址：</td>                            <td>                                <input class="ui-control ui-control-box ui-control-full" type="input" id="mailAddress" name="mailAddress" placeholder="多个地址用英文逗号分割" value="'+t+'" />                            </td>                        </tr>                        <tr>                            <td class="ui-tag">时间段：</td>                            <td><input class="ui-control ui-control-box" type="input" id="from" name="from" value="'+i.start+'" />&nbsp;&nbsp;<input class="ui-control ui-control-box" type="input" id="to" name="to" value="'+i.end+'" /></td>                        </tr>                        <tr>                            <td class="ui-tag"></td>                            <td>                                <input type="submit" class="ui-button ui-button-primary" value="发送">                            </td>                        </tr>                    </table>                </form>            '),this},events:{"submit form#send-mail-form":"startSend","change select#type":"changeType"},changeType:function(t){e("#type").val()=="2"?(e("#name-content").hide(),e("#address-content").show()):e("#type").val()=="1"&&(e("#name-content").show(),e("#address-content").hide())},startSend:function(t){t.preventDefault();var n=this;e("#progress-dialog").dialog({modal:!0,width:428,open:function(t,n){e(this).parent().focus(),e("#progress-bar span").css("width","50%")}});var i=e("#type").val(),s=r(e("#from").val()).format(),o=r(e("#to").val()).add(1,"days").format(),u={},a="",f=e("#mailAddress").val()||"",l=e("#groupName").val()||"";localStorage.setItem("mailAddress",f),localStorage.setItem("groupName",l),i=="1"?(u={groupName:l,start:s,end:o},a="/api/groupToMail?callback=?"):i=="2"&&(u={userName:currentUser,start:s,end:o,mail:f},a="/api/userToMail?callback=?"),e.ajax({type:"get",url:a+"&fullname="+currentFullName,dataType:"jsonp",data:u,scriptCharset:"utf-8"}).done(function(t){e("#progress-bar span").css("width","100%"),e("#progress-dialog").dialog("destroy")})}})}),define("view/syncCalendar",["jquery","underscore","backbone","moment","controller/defaultTime","jqueryUI"],function(e,t,n,r,i){var s=n.View.extend({tagName:"li",className:"sync-history-item",initialize:function(){this.listenTo(this.model,"destroy",this.destroy)},destroy:function(){this.remove()},renderViewMode:function(){e(this.el).html("您于"+this.model.get("time").substr(0,19)+"从Google日历同步<b>"+this.model.get("count")+"</b>条数据("+this.model.get("start").substr(0,19)+"至"+this.model.get("end").substr(0,19)+')，<a class="delete" href="#">删除本次导入记录</a>')},renderCallback:"renderViewMode",render:function(){return this[this.renderCallback](),this},events:{"click .delete":"delete"},"delete":function(e){e.preventDefault();var t=confirm("您确定要删除么？");if(!t)return;this.model.destroy({success:function(e,t){console.log("删除导入记录成功")}}),this.remove()}}),o=n.View.extend({tagName:"ul",className:"sync-history-list",initialize:function(){this.listenTo(this.collection,"add",this.render,this)},render:function(){return e(this.el).empty(),t.each(this.collection.models,function(t,n,r){e(this.el).append((new s({model:t})).render().el)},this),this}}),u=n.View.extend({tagName:"div",className:"sync-calendar-main",initialize:function(){},render:function(){return e(this.el).append('                <form id="sync-calendar-form" class="ui-form sync-calendar-form">                    <table class="sync-calendar-table">                        <tr>                            <td class="ui-tag">ApiKey：</td>                            <td>                                <input class="ui-control ui-control-box ui-control-full" type="text" id="apikey" name="apikey" value="AIzaSyAbgIR2RBPuT9OOGc2lu9Ayavio50-mrRU" />                            </td>                        </tr>                        <tr>                            <td class="ui-tag">日历Id：</td>                            <td>                                <input class="ui-control ui-control-box ui-control-full" type="input" value="stormte@gmail.com" id="id" name="id" />                            </td>                        </tr>                        <tr>                            <td class="ui-tag">时间段：</td>                            <td><input class="ui-control ui-control-box" type="input" id="from" name="from" value="'+i.start+'" />&nbsp;&nbsp;<input class="ui-control ui-control-box" type="input" id="to" name="to" value="'+i.end+'"/></td>                        </tr>                        <tr>                            <td class="ui-tag"></td>                            <td>                                <input type="submit" class="ui-button ui-button-primary" value="开始同步">                            </td>                        </tr>                    </table>                </form>            '),this}});return n.View.extend({tagName:"div",className:"sync-calendar",initialize:function(){},render:function(){return e(this.el).html((new o({collection:this.collection})).render().el),e(this.el).append((new u({collection:this.collection})).render().el),this},events:{"submit form#sync-calendar-form":"startSync"},startSync:function(t){function o(t){e.ajax({type:"post",url:"/api/saveNotes?callback=?",dataType:"jsonp",data:{events:JSON.stringify(t)},scriptCharset:"utf-8",success:function(t){e("#progress-bar span").css("width","100%"),e("#progress-dialog").dialog("destroy")}})}function u(t,n){e.ajax({type:"post",url:"/api/saveRecord?callback=?",dataType:"jsonp",data:{user:currentUser,content:JSON.stringify(t),start:i,end:s,count:n,time:r().format()},scriptCharset:"utf-8",success:function(e){}})}t.preventDefault();var n=this;e("#progress-dialog").dialog({modal:!0,width:428,open:function(t,n){e(this).parent().focus(),e("#progress-bar span").css("width","20%")}});var i=r(e("#from").val()).format(),s=r(e("#to").val()).format();e.ajax({type:"get",url:"https://www.googleapis.com/calendar/v3/calendars/"+encodeURIComponent(e("#id").val())+"/events?callback=?",dataType:"jsonp",data:{key:e("#apikey").val(),timeMin:i,timeMax:s,singleEvents:!0,maxResults:9999},scriptCharset:"utf-8",success:function(t){var r=t.items;e("#progress-bar span").css("width","50%");var i=[],s=[],a=r.length;for(var f=0;f<a;f++)s[f]=r[f].id,i[f]={},i[f].id=r[f].id,i[f].user=currentUser,i[f].type="1",i[f].title=r[f].summary,i[f].remark=r[f].description||"",i[f].status="3",i[f].start=r[f].start.date||r[f].start.dateTime,i[f].end=r[f].end.date||r[f].end.dateTime;e("#progress-bar span").css("width","70%"),o(i),u(s,a),n.collection.fetch({success:function(){console.log("fetch records collection success")}})}})}})}),define("controller/search",["jquery","underscore","backbone","view/search","jqueryUI"],function(e,t,n,r){return function(){e.widget("custom.autocomplete",e.ui.autocomplete,{_renderItem:function(t,n){return e("<li>").append('<a class="search-item-a"><span class="search-item-head"><img src="'+n.head+'" width="25" height="25"/></span><span class="search-item-name">'+n.fullname+"("+n.name+")</span></a>").appendTo(t)},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItemData(t,n)})}}),e("#search-input").autocomplete({source:function(t,n){e.ajax({url:"/api/getUsers",dataType:"jsonp",data:{keyword:t.term},success:function(e){n(e.list)}})},minLength:3,focus:function(t,n){return e("#search-input").val(n.item.name),!1},select:function(t,n){e("#search-input").val(n.item.name)}})}}),function(e){typeof define=="function"&&define.amd?define("fullcalendar",["jquery","moment"],e):e(jQuery,moment)}(function(e,t){function r(e,t){return t.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"t")}function i(e,t){var n=t.longDateFormat("L");return n=n.replace(/^Y+[^\w\s]*|[^\w\s]*Y+$/g,""),e.isRTL?n+=" ddd":n="ddd "+n,n}function f(e){l(n,e)}function l(t){function n(n,r){e.isPlainObject(r)&&e.isPlainObject(t[n])&&!c(n)?t[n]=l({},t[n],r):r!==undefined&&(t[n]=r)}for(var r=1;r<arguments.length;r++)e.each(arguments[r],n);return t}function c(e){return/(Time|Duration)$/.test(e)}function h(r,i){function d(e){var n=t.localeData||t.langData;return n.call(t,e)||n.call(t,"en")}function M(e){x?P()&&(I(),j(e)):_()}function _(){T=c.theme?"ui":"fc",r.addClass("fc"),c.isRTL?r.addClass("fc-rtl"):r.addClass("fc-ltr"),c.theme?r.addClass("ui-widget"):r.addClass("fc-unthemed"),x=e("<div class='fc-view-container'/>").prependTo(r),E=new p(f,c),S=E.render(),S&&r.prepend(S),H(c.defaultView),c.handleWindowResize&&(k=z(U,c.windowResizeDelay),e(window).resize(k))}function D(){N&&N.destroy(),E.destroy(),x.remove(),r.removeClass("fc fc-ltr fc-rtl fc-unthemed ui-widget"),e(window).unbind("resize",k)}function P(){return r.is(":visible")}function H(e){j(0,e)}function j(t,n){L++,N&&n&&N.name!==n&&(E.deactivateButton(N.name),ht(),N.start&&N.destroy(),N.el.remove(),N=null),!N&&n&&(N=new a[n](f),N.el=e("<div class='fc-view fc-"+n+"-view' />").appendTo(x),E.activateButton(n)),N&&(t&&(A=N.incrementDate(A,t)),(!N.start||t||!A.isWithin(N.intervalStart,N.intervalEnd))&&P()&&(ht(),N.start&&N.destroy(),N.render(A),pt(),G(),Y(),$())),pt(),L--}function F(e){if(P())return e&&q(),L++,N.updateSize(!0),L--,!0}function I(){P()&&q()}function q(){typeof c.contentHeight=="number"?C=c.contentHeight:typeof c.height=="number"?C=c.height-(S?S.outerHeight(!0):0):C=Math.round(x.width()/Math.max(c.aspectRatio,.5))}function U(e){!L&&e.target===window&&N.start&&F(!0)&&N.trigger("windowResize",w)}function W(){V(),J()}function X(){P()&&(ht(),N.destroyEvents(),N.renderEvents(O),pt())}function V(){ht(),N.destroyEvents(),pt()}function $(){!c.lazyFetching||y(N.start,N.end)?J():X()}function J(){b(N.start,N.end)}function K(e){O=e,X()}function Q(){X()}function G(){E.updateTitle(N.title)}function Y(){var e=f.getNow();e.isWithin(N.intervalStart,N.intervalEnd)?E.disableButton("today"):E.enableButton("today")}function Z(e,t){e=f.moment(e),t?t=f.moment(t):e.hasTime()?t=e.clone().add(f.defaultTimedEventDuration):t=e.clone().add(f.defaultAllDayEventDuration),N.select(e,t)}function et(){N&&N.unselect()}function tt(){j(-1)}function rt(){j(1)}function it(){A.add(-1,"years"),j()}function st(){A.add(1,"years"),j()}function ut(){A=f.getNow(),j()}function at(e){A=f.moment(e),j()}function ft(e){A.add(t.duration(e)),j()}function lt(e,t){var n,r;if(!t||a[t]===undefined)t=t||"day",n=E.getViewsWithButtons().join(" "),r=n.match(new RegExp("\\w+"+R(t))),r||(r=n.match(/\w+Day/)),t=r?r[0]:"agendaDay";A=e,H(t)}function ct(){return A.clone()}function ht(){x.css({width:"100%",height:x.height(),overflow:"hidden"})}function pt(){x.css({width:"",height:"",overflow:""})}function dt(){return f}function vt(){return N}function mt(e,t){if(t===undefined)return c[e];if(e=="height"||e=="contentHeight"||e=="aspectRatio")c[e]=t,F(!0)}function gt(e,t){if(c[e])return c[e].apply(t||w,Array.prototype.slice.call(arguments,2))}var f=this;i=i||{};var c=l({},n,i),h;c.lang in s?h=s[c.lang]:h=s[n.lang],h&&(c=l({},n,h,i)),c.isRTL&&(c=l({},n,o,h||{},i)),f.options=c,f.render=M,f.destroy=D,f.refetchEvents=W,f.reportEvents=K,f.reportEventChange=Q,f.rerenderEvents=X,f.changeView=H,f.select=Z,f.unselect=et,f.prev=tt,f.next=rt,f.prevYear=it,f.nextYear=st,f.today=ut,f.gotoDate=at,f.incrementDate=ft,f.zoomTo=lt,f.getDate=ct,f.getCalendar=dt,f.getView=vt,f.option=mt,f.trigger=gt;var v=B(d(c.lang));c.monthNames&&(v._months=c.monthNames),c.monthNamesShort&&(v._monthsShort=c.monthNamesShort),c.dayNames&&(v._weekdays=c.dayNames),c.dayNamesShort&&(v._weekdaysShort=c.dayNamesShort);if(c.firstDay!=null){var g=B(v._week);g.dow=c.firstDay,v._week=g}f.defaultAllDayEventDuration=t.duration(c.defaultAllDayEventDuration),f.defaultTimedEventDuration=t.duration(c.defaultTimedEventDuration),f.moment=function(){var e;return c.timezone==="local"?(e=u.moment.apply(null,arguments),e.hasTime()&&e.local()):c.timezone==="UTC"?e=u.moment.utc.apply(null,arguments):e=u.moment.parseZone.apply(null,arguments),"_locale"in e?e._locale=v:e._lang=v,e},f.getIsAmbigTimezone=function(){return c.timezone!=="local"&&c.timezone!=="UTC"},f.rezoneDate=function(e){return f.moment(e.toArray())},f.getNow=function(){var e=c.now;return typeof e=="function"&&(e=e()),f.moment(e)},f.calculateWeekNumber=function(e){var t=c.weekNumberCalculation;if(typeof t=="function")return t(e);if(t==="local")return e.week();if(t.toUpperCase()==="ISO")return e.isoWeek()},f.getEventEnd=function(e){return e.end?e.end.clone():f.getDefaultEventEnd(e.allDay,e.start)},f.getDefaultEventEnd=function(e,t){var n=t.clone();return e?n.stripTime().add(f.defaultAllDayEventDuration):n.add(f.defaultTimedEventDuration),f.getIsAmbigTimezone()&&n.stripZone(),n},f.formatRange=function(e,t,n){return typeof n=="function"&&(n=n.call(f,c,v)),ot(e,t,n,null,c.isRTL)},f.formatDate=function(e,t){return typeof t=="function"&&(t=t.call(f,c,v)),nt(e,t)},m.call(f,c);var y=f.isFetchNeeded,b=f.fetchEvents,w=r[0],E,S,x,T,N,C,k,L=0,A,O=[];c.defaultDate!=null?A=f.moment(c.defaultDate):A=f.getNow(),f.getSuggestedViewHeight=function(){return C===undefined&&I(),C},f.isHeightAuto=function(){return c.contentHeight==="auto"||c.height==="auto"}}function p(t,n){function u(){var t=n.header;o=n.theme?"ui":"fc";if(t)return i=e("<div class='fc-toolbar'/>").append(l("left")).append(l("right")).append(l("center")).append('<div class="fc-clear"/>'),i}function f(){i.remove()}function l(r){var i=e('<div class="fc-'+r+'"/>'),u=n.header[r];return u&&e.each(u.split(" "),function(r){var u=e(),f=!0,l;e.each(this.split(","),function(r,i){var l,c,h,p,d,v,m,g;i=="title"?(u=u.add(e("<h2>&nbsp;</h2>")),f=!1):(t[i]?l=function(){t[i]()}:a[i]&&(l=function(){t.changeView(i)},s.push(i)),l&&(c=M(n.themeButtonIcons,i),h=M(n.buttonIcons,i),p=M(n.defaultButtonText,i),d=M(n.buttonText,i),d?v=I(d):c&&n.theme?v="<span class='ui-icon ui-icon-"+c+"'></span>":h&&!n.theme?v="<span class='fc-icon fc-icon-"+h+"'></span>":v=I(p||i),m=["fc-"+i+"-button",o+"-button",o+"-state-default"],g=e('<button type="button" class="'+m.join(" ")+'">'+v+"</button>").click(function(){g.hasClass(o+"-state-disabled")||(l(),(g.hasClass(o+"-state-active")||g.hasClass(o+"-state-disabled"))&&g.removeClass(o+"-state-hover"))}).mousedown(function(){g.not("."+o+"-state-active").not("."+o+"-state-disabled").addClass(o+"-state-down")}).mouseup(function(){g.removeClass(o+"-state-down")}).hover(function(){g.not("."+o+"-state-active").not("."+o+"-state-disabled").addClass(o+"-state-hover")},function(){g.removeClass(o+"-state-hover").removeClass(o+"-state-down")}),u=u.add(g)))}),f&&u.first().addClass(o+"-corner-left").end().last().addClass(o+"-corner-right").end(),u.length>1?(l=e("<div/>"),f&&l.addClass("fc-button-group"),l.append(u),i.append(l)):i.append(u)}),i}function c(e){i.find("h2").text(e)}function h(e){i.find(".fc-"+e+"-button").addClass(o+"-state-active")}function p(e){i.find(".fc-"+e+"-button").removeClass(o+"-state-active")}function d(e){i.find(".fc-"+e+"-button").attr("disabled","disabled").addClass(o+"-state-disabled")}function v(e){i.find(".fc-"+e+"-button").removeAttr("disabled").removeClass(o+"-state-disabled")}function m(){return s}var r=this;r.render=u,r.destroy=f,r.updateTitle=c,r.activateButton=h,r.deactivateButton=p,r.disableButton=d,r.enableButton=v,r.getViewsWithButtons=m;var i=e(),s=[],o}function m(n){function w(e,t){return!c||e.clone().stripZone()<c.clone().stripZone()||t.clone().stripZone()>h.clone().stripZone()}function E(e,t){c=e,h=t,b=[];var n=++p,r=l.length;m=r;for(var i=0;i<r;i++)S(l[i],n)}function S(t,n){x(t,function(r){var i=e.isArray(t.events),s,u,a;if(n==p){if(r)for(s=0;s<r.length;s++)u=r[s],i?a=u:a=R(u,t),a&&b.push.apply(b,z(a));m--,m||o(b)}})}function x(t,i){var s,o=u.sourceFetchers,a;for(s=0;s<o.length;s++){a=o[s].call(r,t,c.clone(),h.clone(),n.timezone,i);if(a===!0)return;if(typeof a=="object"){x(a,i);return}}var f=t.events;if(f)e.isFunction(f)?(I(),f.call(r,c.clone(),h.clone(),n.timezone,function(e){i(e),q()})):e.isArray(f)?i(f):i();else{var l=t.url;if(l){var p=t.success,v=t.error,m=t.complete,g;e.isFunction(t.data)?g=t.data():g=t.data;var y=e.extend({},g||{}),b=F(t.startParam,n.startParam),w=F(t.endParam,n.endParam),E=F(t.timezoneParam,n.timezoneParam);b&&(y[b]=c.format()),w&&(y[w]=h.format()),n.timezone&&n.timezone!="local"&&(y[E]=n.timezone),I(),e.ajax(e.extend({},d,t,{data:y,success:function(t){t=t||[];var n=j(p,this,arguments);e.isArray(n)&&(t=n),i(t)},error:function(){j(v,this,arguments),i()},complete:function(){j(m,this,arguments),q()}}))}else i()}}function T(e){var t=N(e);t&&(l.push(t),m++,S(t,p))}function N(t){var n=u.sourceNormalizers,i,s;e.isFunction(t)||e.isArray(t)?i={events:t}:typeof t=="string"?i={url:t}:typeof t=="object"&&(i=e.extend({},t));if(i){i.className?typeof i.className=="string"&&(i.className=i.className.split(/\s+/)):i.className=[],e.isArray(i.events)&&(i.origArray=i.events,i.events=e.map(i.events,function(e){return R(e,i)}));for(s=0;s<n.length;s++)n[s].call(r,i);return i}}function C(t){l=e.grep(l,function(e){return!k(e,t)}),b=e.grep(b,function(e){return!k(e.source,t)}),o(b)}function k(e,t){return e&&t&&L(e)==L(t)}function L(e){return(typeof e=="object"?e.origArray||e.googleCalendarId||e.url||e.events:null)||e}function A(e){e.start=r.moment(e.start),e.end&&(e.end=r.moment(e.end)),W(e),M(e),o(b)}function M(e){var t,n,r,i;for(t=0;t<b.length;t++){n=b[t];if(n._id==e._id&&n!==e)for(r=0;r<O.length;r++)i=O[r],e[i]!==undefined&&(n[i]=e[i])}}function _(e,t){var n=R(e),r,i,s;if(n){r=z(n);for(i=0;i<r.length;i++)s=r[i],s.source||(t&&(f.events.push(s),s.source=f),b.push(s));return o(b),r}return[]}function P(t){var n,r;t==null?t=function(){return!0}:e.isFunction(t)||(n=t+"",t=function(e){return e._id==n}),b=e.grep(b,t,!0);for(r=0;r<l.length;r++)e.isArray(l[r].events)&&(l[r].events=e.grep(l[r].events,t,!0));o(b)}function B(t){return e.isFunction(t)?e.grep(b,t):t!=null?(t+="",e.grep(b,function(e){return e._id==t})):b}function I(){y++||i("loading",null,!0,s())}function q(){--y||i("loading",null,!1,s())}function R(i,s){var o={},u,a,f,l;n.eventDataTransform&&(i=n.eventDataTransform(i)),s&&s.eventDataTransform&&(i=s.eventDataTransform(i)),e.extend(o,i),s&&(o.source=s),o._id=i._id||(i.id===undefined?"_fc"+v++:i.id+""),i.className?typeof i.className=="string"?o.className=i.className.split(/\s+/):o.className=i.className:o.className=[],u=i.start||i.date,a=i.end,H(u)&&(u=t.duration(u)),H(a)&&(a=t.duration(a));if(i.dow||t.isDuration(u)||t.isDuration(a))o.start=u?t.duration(u):null,o.end=a?t.duration(a):null,o._recurring=!0;else{if(u){u=r.moment(u);if(!u.isValid())return!1}a&&(a=r.moment(a),a.isValid()||(a=null)),f=i.allDay,f===undefined&&(l=F(s?s.allDayDefault:undefined,n.allDayDefault),l!==undefined?f=l:f=!u.hasTime()&&(!a||!a.hasTime())),U(u,a,f,o)}return o}function U(e,t,i,s){i?(e.hasTime()&&e.stripTime(),t&&t.hasTime()&&t.stripTime()):(e.hasTime()||(e=r.rezoneDate(e)),t&&!t.hasTime()&&(t=r.rezoneDate(t))),t&&t<=e&&(t=null),s.allDay=i,s.start=e,s.end=t||null,n.forceEventDuration&&!s.end&&(s.end=a(s)),g(s)}function z(t,n,r){var i=[],s,o,u,a,f,l,p,d,v;n=n||c,r=r||h;if(t)if(t._recurring){if(o=t.dow){s={};for(u=0;u<o.length;u++)s[o[u]]=!0}a=n.clone().stripTime();while(a.isBefore(r)){if(!s||s[a.day()])f=t.start,l=t.end,p=a.clone(),d=null,f&&(p=p.time(f)),l&&(d=a.clone().time(l)),v=e.extend({},t),U(p,d,!f&&!l,v),i.push(v);a.add(1,"days")}}else i.push(t);return i}function W(e,t,n){var i=e._allDay,s=e._start,o=e._end,u=!1,a,f,l,c;return!t&&!n&&(t=e.start,n=e.end),e.allDay!=i?a=e.allDay:a=!(t||n).hasTime(),a&&(t&&(t=t.clone().stripTime()),n&&(n=n.clone().stripTime())),t&&(a?f=D(t,s.clone().stripTime()):f=D(t,s)),a!=i?u=!0:n&&(l=D(n||r.getDefaultEventEnd(a,t||s),t||s).subtract(D(o||r.getDefaultEventEnd(i,s),s))),c=X(B(e._id),u,a,f,l),{dateDelta:f,durationDelta:l,undo:c}}function X(t,i,s,o,u){var a=r.getIsAmbigTimezone(),f=[];return e.each(t,function(e,t){var l=t._allDay,c=t._start,h=t._end,p=s!=null?s:l,d=c.clone(),v=!i&&h?h.clone():null;p?(d.stripTime(),v&&v.stripTime()):(d.hasTime()||(d=r.rezoneDate(d)),v&&!v.hasTime()&&(v=r.rezoneDate(v))),!v&&(n.forceEventDuration||+u)&&(v=r.getDefaultEventEnd(p,d)),d.add(o),v&&v.add(o).add(u),a&&(+o||+u)&&(d.stripZone(),v&&v.stripZone()),t.allDay=p,t.start=d,t.end=v,g(t),f.push(function(){t.allDay=l,t.start=c,t.end=h,g(t)})}),function(){for(var e=0;e<f.length;e++)f[e]()}}function V(){var t=n.businessHours,i={className:"fc-nonbusiness",start:"09:00",end:"17:00",dow:[1,2,3,4,5],rendering:"inverse-background"},s=r.getView(),o;return t&&(typeof t=="object"?o=e.extend({},i,t):o=i),o?z(R(o),s.start,s.end):[]}function $(e,t,r){var i=e.source||{},s=F(e.constraint,i.constraint,n.eventConstraint),o=F(e.overlap,i.overlap,n.eventOverlap);return Q(t,r,s,o,e)}function J(e,t){return Q(e,t,n.selectConstraint,n.selectOverlap)}function K(e,t,n){var r;if(n){r=z(R(n))[0];if(r)return $(r,e,t)}return J(e,t)}function Q(e,t,n,r,i){var s,o,u,a,f;e=e.clone().stripZone(),t=t.clone().stripZone();if(n!=null){s=G(n),o=!1;for(u=0;u<s.length;u++)if(Y(s[u],e,t)){o=!0;break}if(!o)return!1}for(u=0;u<b.length;u++){a=b[u];if(i&&i._id===a._id)continue;if(Z(a,e,t)){if(r===!1)return!1;if(typeof r=="function"&&!r(a,i))return!1;if(i){f=F(a.overlap,(a.source||{}).overlap);if(f===!1)return!1;if(typeof f=="function"&&!f(i,a))return!1}}}return!0}function G(e){return e==="businessHours"?V():typeof e=="object"?z(R(e)):B(e)}function Y(e,t,n){var i=e.start.clone().stripZone(),s=r.getEventEnd(e).stripZone();return t>=i&&n<=s}function Z(e,t,n){var i=e.start.clone().stripZone(),s=r.getEventEnd(e).stripZone();return t<s&&n>i}var r=this;r.isFetchNeeded=w,r.fetchEvents=E,r.addEventSource=T,r.removeEventSource=C,r.updateEvent=A,r.renderEvent=_,r.removeEvents=P,r.clientEvents=B,r.mutateEvent=W;var i=r.trigger,s=r.getView,o=r.reportEvents,a=r.getEventEnd,f={events:[]},l=[f],c,h,p=0,m=0,y=0,b=[];e.each((n.events?[n.events]:[]).concat(n.eventSources||[]),function(e,t){var n=N(t);n&&l.push(n)});var O=["title","url","allDay","className","editable","color","backgroundColor","borderColor","textColor"];r.getBusinessHoursEvents=V,r.isEventAllowedInRange=$,r.isSelectionAllowedInRange=J,r.isExternalDragAllowedInRange=K}function g(e){e._allDay=e.allDay,e._start=e.start.clone(),e._end=e.end?e.end.clone():null}function y(e,t){t.left&&e.css({"border-left-width":1,"margin-left":t.left-1}),t.right&&e.css({"border-right-width":1,"margin-right":t.right-1})}function b(e){e.css({"margin-left":"","margin-right":"","border-left-width":"","border-right-width":""})}function w(){e("body").addClass("fc-not-allowed")}function E(){e("body").removeClass("fc-not-allowed")}function S(t,n,r){var i=Math.floor(n/t.length),s=Math.floor(n-i*(t.length-1)),o=[],u=[],a=[],f=0;x(t),t.each(function(n,r){var l=n===t.length-1?s:i,c=e(r).outerHeight(!0);c<l?(o.push(r),u.push(c),a.push(e(r).height())):f+=c}),r&&(n-=f,i=Math.floor(n/o.length),s=Math.floor(n-i*(o.length-1))),e(o).each(function(t,n){var r=t===o.length-1?s:i,f=u[t],l=a[t],c=r-(f-l);f<r&&e(n).height(c)})}function x(e){e.height("")}function T(t){var n=0;return t.find("> *").each(function(t,r){var i=e(r).outerWidth();i>n&&(n=i)}),n++,t.width(n),n}function N(e,t){return e.height(t).addClass("fc-scroller"),e[0].scrollHeight-1>e[0].clientHeight?!0:(C(e),!1)}function C(e){e.height("").removeClass("fc-scroller")}function k(t){var n=t.css("position"),r=t.parents().filter(function(){var t=e(this);return/(auto|scroll)/.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return n==="fixed"||!r.length?e(t[0].ownerDocument||document):r}function L(e){var t=e.offset().left,n=t+e.width(),r=e.children(),i=r.offset().left,s=i+r.outerWidth();return{left:i-t,right:n-s}}function A(e){return e.which==1&&!e.ctrlKey}function O(e,t,n,r){var i,s,o,u;if(t>n&&e<r)return e>=n?(i=e.clone(),o=!0):(i=n.clone(),o=!1),t<=r?(s=t.clone(),u=!0):(s=r.clone(),u=!1),{start:i,end:s,isStart:o,isEnd:u}}function M(e,t){e=e||{};if(e[t]!==undefined)return e[t];var n=t.split(/(?=[A-Z])/),r=n.length-1,i;for(;r>=0;r--){i=e[n[r].toLowerCase()];if(i!==undefined)return i}return e["default"]}function D(e,n){return t.duration({days:e.clone().stripTime().diff(n.clone().stripTime(),"days"),ms:e.time()-n.time()})}function P(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function H(e){return/^\d+\:\d+(?:\:\d+\.?(?:\d{3})?)?$/.test(e)}function B(e){var t=function(){};return t.prototype=e,new t}function j(t,n,r){e.isFunction(t)&&(t=[t]);if(t){var i,s;for(i=0;i<t.length;i++)s=t[i].apply(n,r)||s;return s}}function F(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==undefined)return arguments[e]}function I(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function q(e){return e.replace(/&.*?;/g,"")}function R(e){return e.charAt(0).toUpperCase()+e.slice(1)}function U(e,t){return e-t}function z(e,t){var n,r,i,s,o=function(){var u=+(new Date)-s;u<t&&u>0?n=setTimeout(o,t-u):(n=null,e.apply(i,r),n||(i=r=null))};return function(){i=this,r=arguments,s=+(new Date),n||(n=setTimeout(o,t))}}function G(n,r,i){var s=n[0],o=n.length==1&&typeof s=="string",u,a,f,l;if(t.isMoment(s))l=t.apply(null,n),Z(s,l);else if(P(s)||s===undefined)l=t.apply(null,n);else{u=!1,a=!1;if(o){if(W.test(s))s+="-01",n=[s],u=!0,a=!0;else if(f=X.exec(s))u=!f[5],a=!0}else e.isArray(s)&&(a=!0);r?l=t.utc.apply(t,n):l=t.apply(null,n),u?(l._ambigTime=!0,l._ambigZone=!0):i&&(a?l._ambigZone=!0:o&&l.zone(s))}return l._fullCalendar=!0,l}function Y(e,t){var n=[],r=!1,i=!1,s;for(s=0;s<e.length;s++)n.push(u.moment.parseZone(e[s])),r=r||n[s]._ambigTime,i=i||n[s]._ambigZone;for(s=0;s<n.length;s++)r&&!t?n[s].stripTime():i&&n[s].stripZone();return n}function Z(e,t){e._ambigTime?t._ambigTime=!0:t._ambigTime&&(t._ambigTime=!1),e._ambigZone?t._ambigZone=!0:t._ambigZone&&(t._ambigZone=!1)}function et(e,t){e.year(t[0]||0).month(t[1]||0).date(t[2]||0).hours(t[3]||0).minutes(t[4]||0).seconds(t[5]||0).milliseconds(t[6]||0)}function tt(e,t){return $.format.call(e,t)}function nt(e,t){return rt(e,ct(t))}function rt(e,t){var n="",r;for(r=0;r<t.length;r++)n+=st(e,t[r]);return n}function st(e,t){var n,r;if(typeof t=="string")return t;if(n=t.token)return it[n]?it[n](e):tt(e,n);if(t.maybe){r=rt(e,t.maybe);if(r.match(/[1-9]/))return r}return""}function ot(e,t,n,r,i){var s;return e=u.moment.parseZone(e),t=u.moment.parseZone(t),s=(e.localeData||e.lang).call(e),n=s.longDateFormat(n)||n,r=r||" - ",ut(e,t,ct(n),r,i)}function ut(e,t,n,r,i){var s,o,u="",a,f="",l,c="",h="",p="";for(o=0;o<n.length;o++){s=ft(e,t,n[o]);if(s===!1)break;u+=s}for(a=n.length-1;a>o;a--){s=ft(e,t,n[a]);if(s===!1)break;f=s+f}for(l=o;l<=a;l++)c+=st(e,n[l]),h+=st(t,n[l]);if(c||h)i?p=h+r+c:p=c+r+h;return u+p+f}function ft(e,t,n){var r,i;if(typeof n=="string")return n;if(r=n.token){i=at[r.charAt(0)];if(i&&e.isSame(t,i))return tt(e,r)}return!1}function ct(e){return e in lt?lt[e]:lt[e]=ht(e)}function ht(e){var t=[],n=/\[([^\]]*)\]|\(([^\)]*)\)|(LT|(\w)\4*o?)|([^\w\[\(]+)/g,r;while(r=n.exec(e))r[1]?t.push(r[1]):r[2]?t.push({maybe:ht(r[2])}):r[3]?t.push({token:r[3]}):r[5]&&t.push(r[5]);return t}function pt(e){this.options=e||{}}function dt(e){this.grid=e}function vt(e){this.coordMaps=e}function mt(e,t){this.coordMap=e,this.options=t||{}}function gt(e,t){return!e&&!t?!0:e&&t?e.grid===t.grid&&e.row===t.row&&e.col===t.col:!1}function yt(t,n){this.options=n=n||{},this.sourceEl=t,this.parentEl=n.parentEl?e(n.parentEl):t.parent()}function bt(e){this.view=e}function wt(e){bt.call(this,e),this.coordMap=new dt(this),this.elsByFill={}}function Et(e){var t=xt(e);return t==="background"||t==="inverse-background"}function St(e){return xt(e)==="inverse-background"}function xt(e){return F((e.source||{}).rendering,e.rendering)}function Tt(e){var t={},n,r;for(n=0;n<e.length;n++)r=e[n],(t[r._id]||(t[r._id]=[])).push(r);return t}function Nt(e,t){return e.eventStartMS-t.eventStartMS}function Ct(e,t){return e.eventStartMS-t.eventStartMS||t.eventDurationMS-e.eventDurationMS||t.event.allDay-e.event.allDay||(e.event.title||"").localeCompare(t.event.title)}function kt(e){wt.call(this,e)}function Lt(e,t){var n,r;for(n=0;n<t.length;n++){r=t[n];if(r.leftCol<=e.rightCol&&r.rightCol>=e.leftCol)return!0}return!1}function At(e,t){return e.leftCol-t.leftCol}function Ot(e){wt.call(this,e)}function Mt(e){var t,n,r;e.sort(Ct),t=_t(e),Dt(t);if(n=t[0]){for(r=0;r<n.length;r++)Pt(n[r]);for(r=0;r<n.length;r++)Ht(n[r],0,0)}}function _t(e){var t=[],n,r,i;for(n=0;n<e.length;n++){r=e[n];for(i=0;i<t.length;i++)if(!Bt(r,t[i]).length)break;r.level=i,(t[i]||(t[i]=[])).push(r)}return t}function Dt(e){var t,n,r,i,s;for(t=0;t<e.length;t++){n=e[t];for(r=0;r<n.length;r++){i=n[r],i.forwardSegs=[];for(s=t+1;s<e.length;s++)Bt(i,e[s],i.forwardSegs)}}}function Pt(e){var t=e.forwardSegs,n=0,r,i;if(e.forwardPressure===undefined){for(r=0;r<t.length;r++)i=t[r],Pt(i),n=Math.max(n,1+i.forwardPressure);e.forwardPressure=n}}function Ht(e,t,n){var r=e.forwardSegs,i;if(e.forwardCoord===undefined){r.length?(r.sort(Ft),Ht(r[0],t+1,n),e.forwardCoord=r[0].backwardCoord):e.forwardCoord=1,e.backwardCoord=e.forwardCoord-(e.forwardCoord-n)/(t+1);for(i=0;i<r.length;i++)Ht(r[i],0,e.forwardCoord)}}function Bt(e,t,n){n=n||[];for(var r=0;r<t.length;r++)jt(e,t[r])&&n.push(t[r]);return n}function jt(e,t){return e.bottom>t.top&&e.top<t.bottom}function Ft(e,t){return t.forwardPressure-e.forwardPressure||(e.backwardCoord||0)-(t.backwardCoord||0)||Ct(e,t)}function It(n){function u(t){var n=s[t];return e.isPlainObject(n)&&!c(t)?M(n,r.name):n}function a(e,t){return n.trigger.apply(n,[e,t||r].concat(Array.prototype.slice.call(arguments,2),[r]))}function f(e){var t=e.source||{};return F(e.startEditable,t.startEditable,u("eventStartEditable"),e.editable,t.editable,u("editable"))}function l(e){var t=e.source||{};return F(e.durationEditable,t.durationEditable,u("eventDurationEditable"),e.editable,t.editable,u("editable"))}function h(e,t,r,s){var o=n.mutateEvent(t,r,null);a("eventDrop",e,t,o.dateDelta,function(){o.undo(),i()},s,{}),i()}function p(e,t,r,s){var o=n.mutateEvent(t,null,r);a("eventResize",e,t,o.durationDelta,function(){o.undo(),i()},s,{}),i()}function w(e){return t.isMoment(e)&&(e=e.day()),v[e]}function E(){return m}function S(e,t,n){var r=e.clone();t=t||1;while(v[(r.day()+(n?t:0)+7)%7])r.add(t,"days");return r}function x(){var e=T.apply(null,arguments),t=N(e),n=C(t);return n}function T(e,t){var n=r.colCnt,i=b?-1:1,s=b?n-1:0;typeof e=="object"&&(t=e.col,e=e.row);var o=e*n+(t*i+s);return o}function N(e){var t=r.start.day();return e+=g[t],Math.floor(e/m)*7+y[(e%m+m)%m]-t}function C(e){return r.start.clone().add(e,"days")}function k(e){var t=L(e),n=A(t),r=O(n);return r}function L(e){return e.clone().stripTime().diff(r.start,"days")}function A(e){var t=r.start.day();return e+=t,Math.floor(e/7)*m+g[(e%7+7)%7]-g[t]}function O(e){var t=r.colCnt,n=b?-1:1,i=b?t-1:0,s=Math.floor(e/t),o=(e%t+t)%t*n+i;return{row:s,col:o}}function _(e,t){var n=r.rowCnt,i=r.colCnt,s=[],o=D(e,t),u=L(o.start),a=L(o.end),f=A(u),l=A(a)-1;for(var c=0;c<n;c++){var h=c*i,p=h+i-1,d=Math.max(f,h),v=Math.min(l,p);if(d<=v){var m=O(d),g=O(v),y=[m.col,g.col].sort(U),b=N(d)==u,w=N(v)+1==a;s.push({row:c,leftCol:y[0],rightCol:y[1],isStart:b,isEnd:w})}}return s}function D(e,t){var n=e.clone().stripTime(),r,i;t&&(r=t.clone().stripTime(),i=+t.time(),i&&i>=o&&r.add(1,"days"));if(!t||r<=n)r=n.clone().add(1,"days");return{start:n,end:r}}function P(e){var t=D(e.start,e.end);return t.end.diff(t.start,"days")>1}var r=this;r.calendar=n,r.opt=u,r.trigger=a,r.isEventDraggable=f,r.isEventResizable=l,r.eventDrop=h,r.eventResize=p;var i=n.reportEventChange,s=n.options,o=t.duration(s.nextDayThreshold);r.init(),r.getEventTimeText=function(e,t){var r,i;return typeof e=="object"&&typeof t=="object"?(r=e,i=t,t=arguments[2]):(r=e.start,i=e.end),t=t||u("timeFormat"),i&&u("displayEventEnd")?n.formatRange(r,i,t):n.formatDate(r,t)},r.isHiddenDay=w,r.skipHiddenDays=S,r.getCellsPerWeek=E,r.dateToCell=k,r.dateToDayOffset=L,r.dayOffsetToCellOffset=A,r.cellOffsetToCell=O,r.cellToDate=x,r.cellToCellOffset=T,r.cellOffsetToDayOffset=N,r.dayOffsetToDate=C,r.rangeToSegments=_,r.isMultiDayEvent=P;var d=u("hiddenDays")||[],v=[],m,g=[],y=[],b=u("isRTL");(function(){u("weekends")===!1&&d.push(0,6);for(var t=0,n=0;t<7;t++)g[t]=n,v[t]=e.inArray(t,d)!=-1,v[t]||(y[n]=t,n++);m=n;if(!m)throw"invalid hiddenDays"})()}function qt(n){var r=u.dataAttrPrefix,i,s,o,a;return r&&(r+="-"),i=n.data(r+"event")||null,i&&(typeof i=="object"?i=e.extend({},i):i={},s=i.start,s==null&&(s=i.time),o=i.duration,a=i.stick,delete i.start,delete i.time,delete i.duration,delete i.stick),s==null&&(s=n.data(r+"start")),s==null&&(s=n.data(r+"time")),o==null&&(o=n.data(r+"duration")),a==null&&(a=n.data(r+"stick")),s=s!=null?t.duration(s):null,o=o!=null?t.duration(o):null,a=Boolean(a),{eventProps:i,startTime:s,duration:o,stick:a}}function Rt(e){It.call(this,e),this.dayGrid=new kt(this),this.coordMap=this.dayGrid.coordMap}function Ut(e){Rt.call(this,e)}function zt(e){Rt.call(this,e)}function Wt(e){Rt.call(this,e)}function Vt(e,t){return t.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"a")}function $t(e,t){return t.longDateFormat("LT").replace(/\s*a$/i,"")}function Jt(e){It.call(this,e),this.timeGrid=new Ot(this),this.opt("allDaySlot")?(this.dayGrid=new kt(this),this.coordMap=new vt([this.dayGrid.coordMap,this.timeGrid.coordMap])):this.coordMap=this.timeGrid.coordMap}function Kt(e){Jt.call(this,e)}function Qt(e){Jt.call(this,e)}var n={lang:"en",defaultTimedEventDuration:"02:00:00",defaultAllDayEventDuration:{days:1},forceEventDuration:!1,nextDayThreshold:"09:00:00",defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberTitle:"W",weekNumberCalculation:"local",lazyFetching:!0,startParam:"start",endParam:"end",timezoneParam:"timezone",timezone:!1,titleFormat:{month:"MMMM YYYY",week:"ll",day:"LL"},columnFormat:{month:"ddd",week:i,day:"dddd"},timeFormat:{"default":r},displayEventEnd:{month:!1,basicWeek:!1,"default":!0},isRTL:!1,defaultButtonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",today:"today",month:"month",week:"week",day:"day"},buttonIcons:{prev:"left-single-arrow",next:"right-single-arrow",prevYear:"left-double-arrow",nextYear:"right-double-arrow"},theme:!1,themeButtonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e",prevYear:"seek-prev",nextYear:"seek-next"},dragOpacity:.75,dragRevertDuration:500,dragScroll:!0,unselectAuto:!0,dropAccept:"*",eventLimit:!1,eventLimitText:"more",eventLimitClick:"popover",dayPopoverFormat:"LL",handleWindowResize:!0,windowResizeDelay:200},s={en:{columnFormat:{week:"ddd M/D"},dayPopoverFormat:"dddd, MMMM D"}},o={header:{left:"next,prev today",center:"",right:"title"},buttonIcons:{prev:"right-single-arrow",next:"left-single-arrow",prevYear:"right-double-arrow",nextYear:"left-double-arrow"},themeButtonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w",nextYear:"seek-prev",prevYear:"seek-next"}},u=e.fullCalendar={version:"2.2.3"},a=u.views={};e.fn.fullCalendar=function(t){var n=Array.prototype.slice.call(arguments,1),r=this;return this.each(function(i,s){var o=e(s),u=o.data("fullCalendar"),a;typeof t=="string"?u&&e.isFunction(u[t])&&(a=u[t].apply(u,n),i||(r=a),t==="destroy"&&o.removeData("fullCalendar")):u||(u=new h(o,t),o.data("fullCalendar",u),u.render())}),r},u.langs=s,u.datepickerLang=function(t,n,r){var i=s[t];i||(i=s[t]={}),l(i,{isRTL:r.isRTL,weekNumberTitle:r.weekHeader,titleFormat:{month:r.showMonthAfterYear?"YYYY["+r.yearSuffix+"] MMMM":"MMMM YYYY["+r.yearSuffix+"]"},defaultButtonText:{prev:q(r.prevText),next:q(r.nextText),today:q(r.currentText)}}),e.datepicker&&(e.datepicker.regional[n]=e.datepicker.regional[t]=r,e.datepicker.regional.en=e.datepicker.regional[""],e.datepicker.setDefaults(r))},u.lang=function(e,t){var r;t&&(r=s[e],r||(r=s[e]={}),l(r,t||{})),n.lang=e},u.sourceNormalizers=[],u.sourceFetchers=[];var d={dataType:"json",cache:!1},v=1,_=["sun","mon","tue","wed","thu","fri","sat"];u.applyAll=j;var W=/^\s*\d{4}-\d\d$/,X=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?)?$/,V=t.fn,$=e.extend({},V),J,K,Q;u.moment=function(){return G(arguments)},u.moment.utc=function(){var e=G(arguments,!0);return e.hasTime()&&e.utc(),e},u.moment.parseZone=function(){return G(arguments,!0,!0)},V.clone=function(){var e=$.clone.apply(this,arguments);return Z(this,e),this._fullCalendar&&(e._fullCalendar=!0),e},V.time=function(e){if(!this._fullCalendar)return $.time.apply(this,arguments);if(e==null)return t.duration({hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()});this._ambigTime=!1,!t.isDuration(e)&&!t.isMoment(e)&&(e=t.duration(e));var n=0;return t.isDuration(e)&&(n=Math.floor(e.asDays())*24),this.hours(n+e.hours()).minutes(e.minutes()).seconds(e.seconds()).milliseconds(e.milliseconds())},V.stripTime=function(){var e=this.toArray();return this.utc(),K(this,e.slice(0,3)),this._ambigTime=!0,this._ambigZone=!0,this},V.hasTime=function(){return!this._ambigTime},V.stripZone=function(){var e=this.toArray(),t=this._ambigTime;return this.utc(),K(this,e),t&&(this._ambigTime=!0),this._ambigZone=!0,this},V.hasZone=function(){return!this._ambigZone},V.zone=function(e){return e!=null&&(this._ambigTime=!1,this._ambigZone=!1),$.zone.apply(this,arguments)},V.local=function(){var e=this.toArray(),t=this._ambigZone;return $.local.apply(this,arguments),t&&Q(this,e),this},V.format=function(){return this._fullCalendar&&arguments[0]?nt(this,arguments[0]):this._ambigTime?tt(this,"YYYY-MM-DD"):this._ambigZone?tt(this,"YYYY-MM-DD[T]HH:mm:ss"):$.format.apply(this,arguments)},V.toISOString=function(){return this._ambigTime?tt(this,"YYYY-MM-DD"):this._ambigZone?tt(this,"YYYY-MM-DD[T]HH:mm:ss"):$.toISOString.apply(this,arguments)},V.isWithin=function(e,t){var n=Y([this,e,t]);return n[0]>=n[1]&&n[0]<n[2]},V.isSame=function(e,t){var n;return this._fullCalendar?t?(n=Y([this,e],!0),$.isSame.call(n[0],n[1],t)):(e=u.moment.parseZone(e),$.isSame.call(this,e)&&Boolean(this._ambigTime)===Boolean(e._ambigTime)&&Boolean(this._ambigZone)===Boolean(e._ambigZone)):$.isSame.apply(this,arguments)},e.each(["isBefore","isAfter"],function(e,t){V[t]=function(e,n){var r;return this._fullCalendar?(r=Y([this,e]),$[t].call(r[0],r[1],n)):$[t].apply(this,arguments)}}),J="_d"in t()&&"updateOffset"in t,K=J?function(e,n){e._d.setTime(Date.UTC.apply(Date,n)),t.updateOffset(e,!1)}:et,Q=J?function(e,n){e._d.setTime(+(new Date(n[0]||0,n[1]||0,n[2]||0,n[3]||0,n[4]||0,n[5]||0,n[6]||0))),t.updateOffset(e,!1)}:et;var it={t:function(e){return tt(e,"a").charAt(0)},T:function(e){return tt(e,"A").charAt(0)}};u.formatRange=ot;var at={Y:"year",M:"month",D:"day",d:"day",A:"second",a:"second",T:"second",t:"second",H:"second",h:"second",m:"second",s:"second"},lt={};pt.prototype={isHidden:!0,options:null,el:null,documentMousedownProxy:null,margin:10,show:function(){this.isHidden&&(this.el||this.render(),this.el.show(),this.position(),this.isHidden=!1,this.trigger("show"))},hide:function(){this.isHidden||(this.el.hide(),this.isHidden=!0,this.trigger("hide"))},render:function(){var t=this,n=this.options;this.el=e('<div class="fc-popover"/>').addClass(n.className||"").css({top:0,left:0}).append(n.content).appendTo(n.parentEl),this.el.on("click",".fc-close",function(){t.hide()}),n.autoHide&&e(document).on("mousedown",this.documentMousedownProxy=e.proxy(this,"documentMousedown"))},documentMousedown:function(t){this.el&&!e(t.target).closest(this.el).length&&this.hide()},destroy:function(){this.hide(),this.el&&(this.el.remove(),this.el=null),e(document).off("mousedown",this.documentMousedownProxy)},position:function(){var t=this.options,n=this.el.offsetParent().offset(),r=this.el.outerWidth(),i=this.el.outerHeight(),s=e(window),o=k(this.el),u,a,f,l,c;l=t.top||0,t.left!==undefined?c=t.left:t.right!==undefined?c=t.right-r:c=0,o.is(window)||o.is(document)?(o=s,u=0,a=0):(f=o.offset(),u=f.top,a=f.left),u+=s.scrollTop(),a+=s.scrollLeft(),t.viewportConstrain!==!1&&(l=Math.min(l,u+o.outerHeight()-i-this.margin),l=Math.max(l,u+this.margin),c=Math.min(c,a+o.outerWidth()-r-this.margin),c=Math.max(c,a+this.margin)),this.el.css({top:l-n.top,left:c-n.left})},trigger:function(e){this.options[e]&&this.options[e].apply(this,Array.prototype.slice.call(arguments,1))}},dt.prototype={grid:null,rows:null,cols:null,containerEl:null,minX:null,maxX:null,minY:null,maxY:null,build:function(){this.grid.buildCoords(this.rows=[],this.cols=[]),this.computeBounds()},getCell:function(e,t){var n=null,r=this.rows,i=this.cols,s=-1,o=-1,u;if(this.inBounds(e,t)){for(u=0;u<r.length;u++)if(t>=r[u][0]&&t<r[u][1]){s=u;break}for(u=0;u<i.length;u++)if(e>=i[u][0]&&e<i[u][1]){o=u;break}s>=0&&o>=0&&(n={row:s,col:o},n.grid=this.grid,n.date=this.grid.getCellDate(n))}return n},computeBounds:function(){var e;this.containerEl&&(e=this.containerEl.offset(),this.minX=e.left,this.maxX=e.left+this.containerEl.outerWidth(),this.minY=e.top,this.maxY=e.top+this.containerEl.outerHeight())},inBounds:function(e,t){return this.containerEl?e>=this.minX&&e<this.maxX&&t>=this.minY&&t<this.maxY:!0}},vt.prototype={coordMaps:null,build:function(){var e=this.coordMaps,t;for(t=0;t<e.length;t++)e[t].build()},getCell:function(e,t){var n=this.coordMaps,r=null,i;for(i=0;i<n.length&&!r;i++)r=n[i].getCell(e,t);return r}},mt.prototype={coordMap:null,options:null,isListening:!1,isDragging:!1,origCell:null,origDate:null,cell:null,date:null,mouseX0:null,mouseY0:null,mousemoveProxy:null,mouseupProxy:null,scrollEl:null,scrollBounds:null,scrollTopVel:null,scrollLeftVel:null,scrollIntervalId:null,scrollHandlerProxy:null,scrollSensitivity:30,scrollSpeed:200,scrollIntervalMs:50,mousedown:function(e){A(e)&&(e.preventDefault(),this.startListening(e),this.options.distance||this.startDrag(e))},startListening:function(t){var n,r;this.isListening||(t&&this.options.scroll&&(n=k(e(t.target)),!n.is(window)&&!n.is(document)&&(this.scrollEl=n,this.scrollHandlerProxy=z(e.proxy(this,"scrollHandler"),100),this.scrollEl.on("scroll",this.scrollHandlerProxy))),this.computeCoords(),t&&(r=this.getCell(t),this.origCell=r,this.origDate=r?r.date:null,this.mouseX0=t.pageX,this.mouseY0=t.pageY),e(document).on("mousemove",this.mousemoveProxy=e.proxy(this,"mousemove")).on("mouseup",this.mouseupProxy=e.proxy(this,"mouseup")).on("selectstart",this.preventDefault),this.isListening=!0,this.trigger("listenStart",t))},computeCoords:function(){this.coordMap.build(),this.computeScrollBounds()},mousemove:function(e){var t,n;this.isDragging||(t=this.options.distance||1,n=Math.pow(e.pageX-this.mouseX0,2)+Math.pow(e.pageY-this.mouseY0,2),n>=t*t&&this.startDrag(e)),this.isDragging&&this.drag(e)},startDrag:function(e){var t;this.isListening||this.startListening(),this.isDragging||(this.isDragging=!0,this.trigger("dragStart",e),t=this.getCell(e),t&&this.cellOver(t,!0))},drag:function(e){var t;this.isDragging&&(t=this.getCell(e),gt(t,this.cell)||(this.cell&&this.cellOut(),t&&this.cellOver(t)),this.dragScroll(e))},cellOver:function(e){this.cell=e,this.date=e.date,this.trigger("cellOver",e,e.date)},cellOut:function(){this.cell&&(this.trigger("cellOut",this.cell),this.cell=null,this.date=null)},mouseup:function(e){this.stopDrag(e),this.stopListening(e)},stopDrag:function(e){this.isDragging&&(this.stopScrolling(),this.trigger("dragStop",e),this.isDragging=!1)},stopListening:function(t){this.isListening&&(this.scrollEl&&(this.scrollEl.off("scroll",this.scrollHandlerProxy),this.scrollHandlerProxy=null),e(document).off("mousemove",this.mousemoveProxy).off("mouseup",this.mouseupProxy).off("selectstart",this.preventDefault),this.mousemoveProxy=null,this.mouseupProxy=null,this.isListening=!1,this.trigger("listenStop",t),this.origCell=this.cell=null,this.origDate=this.date=null)},getCell:function(e){return this.coordMap.getCell(e.pageX,e.pageY)},trigger:function(e){this.options[e]&&this.options[e].apply(this,Array.prototype.slice.call(arguments,1))},preventDefault:function(e){e.preventDefault()},computeScrollBounds:function(){var e=this.scrollEl,t;e&&(t=e.offset(),this.scrollBounds={top:t.top,left:t.left,bottom:t.top+e.outerHeight(),right:t.left+e.outerWidth()})},dragScroll:function(e){var t=this.scrollSensitivity,n=this.scrollBounds,r,i,s,o,u=0,a=0;n&&(r=(t-(e.pageY-n.top))/t,i=(t-(n.bottom-e.pageY))/t,s=(t-(e.pageX-n.left))/t,o=(t-(n.right-e.pageX))/t,r>=0&&r<=1?u=r*this.scrollSpeed*-1:i>=0&&i<=1&&(u=i*this.scrollSpeed),s>=0&&s<=1?a=s*this.scrollSpeed*-1:o>=0&&o<=1&&(a=o*this.scrollSpeed)),this.setScrollVel(u,a)},setScrollVel:function(t,n){this.scrollTopVel=t,this.scrollLeftVel=n,this.constrainScrollVel(),(this.scrollTopVel||this.scrollLeftVel)&&!this.scrollIntervalId&&(this.scrollIntervalId=setInterval(e.proxy(this,"scrollIntervalFunc"),this.scrollIntervalMs))},constrainScrollVel:function(){var e=this.scrollEl;this.scrollTopVel<0?e.scrollTop()<=0&&(this.scrollTopVel=0):this.scrollTopVel>0&&e.scrollTop()+e[0].clientHeight>=e[0].scrollHeight&&(this.scrollTopVel=0),this.scrollLeftVel<0?e.scrollLeft()<=0&&(this.scrollLeftVel=0):this.scrollLeftVel>0&&e.scrollLeft()+e[0].clientWidth>=e[0].scrollWidth&&(this.scrollLeftVel=0)},scrollIntervalFunc:function(){var e=this.scrollEl,t=this.scrollIntervalMs/1e3;this.scrollTopVel&&e.scrollTop(e.scrollTop()+this.scrollTopVel*t),this.scrollLeftVel&&e.scrollLeft(e.scrollLeft()+this.scrollLeftVel*t),this.constrainScrollVel(),!this.scrollTopVel&&!this.scrollLeftVel&&this.stopScrolling()},stopScrolling:function(){this.scrollIntervalId&&(clearInterval(this.scrollIntervalId),this.scrollIntervalId=null,this.computeCoords())},scrollHandler:function(){this.scrollIntervalId||this.computeCoords()}},yt.prototype={options:null,sourceEl:null,el:null,parentEl:null,top0:null,left0:null,mouseY0:null,mouseX0:null,topDelta:null,leftDelta:null,mousemoveProxy:null,isFollowing:!1,isHidden:!1,isAnimating:!1,start:function(t){this.isFollowing||(this.isFollowing=!0,this.mouseY0=t.pageY,this.mouseX0=t.pageX,this.topDelta=0,this.leftDelta=0,this.isHidden||this.updatePosition(),e(document).on("mousemove",this.mousemoveProxy=e.proxy(this,"mousemove")))},stop:function(t,n){function s(){this.isAnimating=!1,r.destroyEl(),this.top0=this.left0=null,n&&n()}var r=this,i=this.options.revertDuration;this.isFollowing&&!this.isAnimating&&(this.isFollowing=!1,e(document).off("mousemove",this.mousemoveProxy),t&&i&&!this.isHidden?(this.isAnimating=!0,this.el.animate({top:this.top0,left:this.left0},{duration:i,complete:s})):s())},getEl:function(){var e=this.el;return e||(this.sourceEl.width(),e=this.el=this.sourceEl.clone().css({position:"absolute",visibility:"",display:this.isHidden?"none":"",margin:0,right:"auto",bottom:"auto",width:this.sourceEl.width(),height:this.sourceEl.height(),opacity:this.options.opacity||"",zIndex:this.options.zIndex}).appendTo(this.parentEl)),e},destroyEl:function(){this.el&&(this.el.remove(),this.el=null)},updatePosition:function(){var e,t;this.getEl(),this.top0===null&&(this.sourceEl.width(),e=this.sourceEl.offset(),t=this.el.offsetParent().offset(),this.top0=e.top-t.top,this.left0=e.left-t.left),this.el.css({top:this.top0+this.topDelta,left:this.left0+this.leftDelta})},mousemove:function(e){this.topDelta=e.pageY-this.mouseY0,this.leftDelta=e.pageX-this.mouseX0,this.isHidden||this.updatePosition()},hide:function(){this.isHidden||(this.isHidden=!0,this.el&&this.el.hide())},show:function(){this.isHidden&&(this.isHidden=!1,this.updatePosition(),this.getEl().show())}},bt.prototype={view:null,cellHtml:"<td/>",rowHtml:function(e,t){var n=this.view,r=this.getHtmlRenderer("cell",e),i="",s,o;t=t||0;for(s=0;s<n.colCnt;s++)o=n.cellToDate(t,s),i+=r(t,s,o);return i=this.bookendCells(i,e,t),"<tr>"+i+"</tr>"},bookendCells:function(e,t,n){var r=this.view,i=this.getHtmlRenderer("intro",t)(n||0),s=this.getHtmlRenderer("outro",t)(n||0),o=r.opt("isRTL"),u=o?s:i,a=o?i:s;return typeof e=="string"?u+e+a:e.prepend(u).append(a)},getHtmlRenderer:function(e,t){var n=this.view,r,i,s,o;r=e+"Html",t&&(i=t+R(e)+"Html");if(i&&(o=n[i]))s=n;else if(i&&(o=this[i]))s=this;else if(o=n[r])s=n;else if(o=this[r])s=this;return typeof o=="function"?function(){return o.apply(s,arguments)||""}:function(){return o||""}}},wt.prototype=B(bt.prototype),e.extend(wt.prototype,{el:null,coordMap:null,cellDuration:null,elsByFill:null,render:function(){this.bindHandlers()},destroy:function(){},buildCoords:function(e,t){},getCellDate:function(e){},getCellDayEl:function(e){},rangeToSegs:function(e,t){},bindHandlers:function(){var t=this;this.el.on("mousedown",function(n){!e(n.target).is(".fc-event-container *, .fc-more")&&!e(n.target).closest(".fc-popover").length&&t.dayMousedown(n)}),this.bindSegHandlers()},dayMousedown:function(e){var t=this,n=this.view,r=n.calendar,i=n.opt("selectable"),s=null,o,u,a,f=new mt(this.coordMap,{scroll:n.opt("dragScroll"),dragStart:function(){n.unselect()},cellOver:function(e,n){f.origDate&&(a=t.getCellDayEl(e),s=[n,f.origDate].sort(U),o=s[0],u=s[1].clone().add(t.cellDuration),i&&(r.isSelectionAllowedInRange(o,u)?t.renderSelection(o,u):(s=null,w())))},cellOut:function(e,n){s=null,t.destroySelection(),E()},listenStop:function(e){s&&(s[0].isSame(s[1])&&n.trigger("dayClick",a[0],o,e),i&&n.reportSelection(o,u,e)),E()}});f.mousedown(e)},renderDrag:function(e,t,n){},destroyDrag:function(){},renderResize:function(e,t,n){},destroyResize:function(){},renderRangeHelper:function(e,t,n){var r=this.view,i;!t&&r.opt("forceEventDuration")&&(t=r.calendar.getDefaultEventEnd(!e.hasTime(),e)),i=n?B(n.event):{},i.start=e,i.end=t,i.allDay=!(e.hasTime()||t&&t.hasTime()),i.className=(i.className||[]).concat("fc-helper"),n||(i.editable=!1),this.renderHelper(i,n)},renderHelper:function(e,t){},destroyHelper:function(){},renderSelection:function(e,t){this.renderHighlight(e,t)},destroySelection:function(){this.destroyHighlight()},renderHighlight:function(e,t){this.renderFill("highlight",this.rangeToSegs(e,t))},destroyHighlight:function(){this.destroyFill("highlight")},highlightSegClasses:function(){return["fc-highlight"]},renderFill:function(e,t){},destroyFill:function(e){var t=this.elsByFill[e];t&&(t.remove(),delete this.elsByFill[e])},renderFillSegEls:function(t,n){var r=this,i=this[t+"SegEl"],s="",o=[],u;if(n.length){for(u=0;u<n.length;u++)s+=this.fillSegHtml(t,n[u]);e(s).each(function(t,s){var u=n[t],a=e(s);i&&(a=i.call(r,u,a)),a&&(a=e(a),a.is(r.fillSegTag)&&(u.el=a,o.push(u)))})}return o},fillSegTag:"div",fillSegHtml:function(e,t){var n=this[e+"SegClasses"],r=this[e+"SegStyles"],i=n?n.call(this,t):[],s=r?r.call(this,t):"";return"<"+this.fillSegTag+(i.length?' class="'+i.join(" ")+'"':"")+(s?' style="'+s+'"':"")+" />"},headHtml:function(){return'<div class="fc-row '+this.view.widgetHeaderClass+'">'+"<table>"+"<thead>"+this.rowHtml("head")+"</thead>"+"</table>"+"</div>"},headCellHtml:function(e,t,n){var r=this.view,i=r.calendar,s=r.opt("columnFormat");return'<th class="fc-day-header '+r.widgetHeaderClass+" fc-"+_[n.day()]+'">'+I(i.formatDate(n,s))+"</th>"},bgCellHtml:function(e,t,n){var r=this.view,i=this.getDayClasses(n);return i.unshift("fc-day",r.widgetContentClass),'<td class="'+i.join(" ")+'" data-date="'+n.format()+'"></td>'},getDayClasses:function(e){var t=this.view,n=t.calendar.getNow().stripTime(),r=["fc-"+_[e.day()]];return t.name==="month"&&e.month()!=t.intervalStart.month()&&r.push("fc-other-month"),e.isSame(n,"day")?r.push("fc-today",t.highlightStateClass):e<n?r.push("fc-past"):r.push("fc-future"),r}}),e.extend(wt.prototype,{mousedOverSeg:null,isDraggingSeg:!1,isResizingSeg:!1,segs:null,renderEvents:function(e){var t=this.eventsToSegs(e),n=[],r=[],i,s;for(i=0;i<t.length;i++)s=t[i],Et(s.event)?n.push(s):r.push(s);n=this.renderBgSegs(n)||n,r=this.renderFgSegs(r)||r,this.segs=n.concat(r)},destroyEvents:function(){this.triggerSegMouseout(),this.destroyFgSegs(),this.destroyBgSegs(),this.segs=null},getSegs:function(){return this.segs||[]},renderFgSegs:function(e){},destroyFgSegs:function(){},renderFgSegEls:function(t,n){var r=this.view,i="",s=[],o;if(t.length){for(o=0;o<t.length;o++)i+=this.fgSegHtml(t[o],n);e(i).each(function(n,i){var o=t[n],u=r.resolveEventEl(o.event,e(i));u&&(u.data("fc-seg",o),o.el=u,s.push(o))})}return s},fgSegHtml:function(e,t){},renderBgSegs:function(e){return this.renderFill("bgEvent",e)},destroyBgSegs:function(){this.destroyFill("bgEvent")},bgEventSegEl:function(e,t){return this.view.resolveEventEl(e.event,t)},bgEventSegClasses:function(e){var t=e.event,n=t.source||{};return["fc-bgevent"].concat(t.className,n.className||[])},bgEventSegStyles:function(e){var t=this.view,n=e.event,r=n.source||{},i=n.color,s=r.color,o=t.opt("eventColor"),u=n.backgroundColor||i||r.backgroundColor||s||t.opt("eventBackgroundColor")||o;return u?"background-color:"+u:""},businessHoursSegClasses:function(e){return["fc-nonbusiness","fc-bgevent"]},bindSegHandlers:function(){var t=this,n=this.view;e.each({mouseenter:function(e,n){t.triggerSegMouseover(e,n)},mouseleave:function(e,n){t.triggerSegMouseout(e,n)},click:function(e,t){return n.trigger("eventClick",this,e.event,t)},mousedown:function(r,i){e(i.target).is(".fc-resizer")&&n.isEventResizable(r.event)?t.segResizeMousedown(r,i):n.isEventDraggable(r.event)&&t.segDragMousedown(r,i)}},function(n,r){t.el.on(n,".fc-event-container > *",function(n){var i=e(this).data("fc-seg");if(i&&!t.isDraggingSeg&&!t.isResizingSeg)return r.call(this,i,n)})})},triggerSegMouseover:function(e,t){this.mousedOverSeg||(this.mousedOverSeg=e,this.view.trigger("eventMouseover",e.el[0],e.event,t))},triggerSegMouseout:function(e,t){t=t||{},this.mousedOverSeg&&(e=e||this.mousedOverSeg,this.mousedOverSeg=null,this.view.trigger("eventMouseout",e.el[0],e.event,t))},segDragMousedown:function(e,t){var n=this,r=this.view,i=r.calendar,s=e.el,o=e.event,u,a,f=new yt(e.el,{parentEl:r.el,opacity:r.opt("dragOpacity"),revertDuration:r.opt("dragRevertDuration"),zIndex:2}),l=new mt(r.coordMap,{distance:5,scroll:r.opt("dragScroll"),listenStart:function(e){f.hide(),f.start(e)},dragStart:function(t){n.triggerSegMouseout(e,t),n.isDraggingSeg=!0,r.hideEvent(o),r.trigger("eventDragStart",s[0],o,t,{})},cellOver:function(t,s){var c=e.cellDate||l.origDate,h=n.computeDraggedEventDates(e,c,s);u=h.start,a=h.end,i.isEventAllowedInRange(o,u,h.visibleEnd)?r.renderDrag(u,a,e)?f.hide():f.show():(u=null,f.show(),w())},cellOut:function(){u=null,r.destroyDrag(),f.show(),E()},dragStop:function(e){var t=u&&!u.isSame(o.start);f.stop(!t,function(){n.isDraggingSeg=!1,r.destroyDrag(),r.showEvent(o),r.trigger("eventDragStop",s[0],o,e,{}),t&&r.eventDrop(s[0],o,u,e)}),E()},listenStop:function(){f.stop()}});l.mousedown(t)},computeDraggedEventDates:function(e,t,n){var r=this.view,i=e.event,s=i.start,o=r.calendar.getEventEnd(i),u,a,f,l,c;return n.hasTime()===t.hasTime()?(u=D(n,t),a=s.clone().add(u),i.end===null?f=null:f=o.clone().add(u),l=i.allDay):(a=n,f=null,l=!n.hasTime()),c=f||r.calendar.getDefaultEventEnd(l,a),{start:a,end:f,visibleEnd:c}},segResizeMousedown:function(e,t){function c(){n.destroyResize(),r.showEvent(o)}var n=this,r=this.view,i=r.calendar,s=e.el,o=e.event,u=o.start,a=r.calendar.getEventEnd(o),f=null,l;l=new mt(this.coordMap,{distance:5,scroll:r.opt("dragScroll"),dragStart:function(t){n.triggerSegMouseout(e,t),n.isResizingSeg=!0,r.trigger("eventResizeStart",s[0],o,t,{})},cellOver:function(t,s){s.isBefore(u)&&(s=u),f=s.clone().add(n.cellDuration),i.isEventAllowedInRange(o,u,f)?f.isSame(a)?(f=null,c()):(n.renderResize(u,f,e),r.hideEvent(o)):(f=null,c(),w())},cellOut:function(){f=null,c(),E()},dragStop:function(e){n.isResizingSeg=!1,c(),E(),r.trigger("eventResizeStop",s[0],o,e,{}),f&&r.eventResize(s[0],o,f,e)}}),l.mousedown(t)},getSegClasses:function(e,t,n){var r=e.event,i=["fc-event",e.isStart?"fc-start":"fc-not-start",e.isEnd?"fc-end":"fc-not-end"].concat(r.className,r.source?r.source.className:[]);return t&&i.push("fc-draggable"),n&&i.push("fc-resizable"),i},getEventSkinCss:function(e){var t=this.view,n=e.source||{},r=e.color,i=n.color,s=t.opt("eventColor"),o=e.backgroundColor||r||n.backgroundColor||i||t.opt("eventBackgroundColor")||s,u=e.borderColor||r||n.borderColor||i||t.opt("eventBorderColor")||s,a=e.textColor||n.textColor||t.opt("eventTextColor"),f=[];return o&&f.push("background-color:"+o),u&&f.push("border-color:"+u),a&&f.push("color:"+a),f.join(";")},eventsToSegs:function(e,t){var n=this.eventsToRanges(e),r=[],i;for(i=0;i<n.length;i++)r.push.apply(r,this.eventRangeToSegs(n[i],t));return r},eventsToRanges:function(t){var n=this,r=Tt(t),i=[];return e.each(r,function(e,t){t.length&&i.push.apply(i,St(t[0])?n.eventsToInverseRanges(t):n.eventsToNormalRanges(t))}),i},eventsToNormalRanges:function(e){var t=this.view.calendar,n=[],r,i,s,o;for(r=0;r<e.length;r++)i=e[r],s=i.start.clone().stripZone(),o=t.getEventEnd(i).stripZone(),n.push({event:i,start:s,end:o,eventStartMS:+s,eventDurationMS:o-s});return n},eventsToInverseRanges:function(e){var t=this.view,n=t.start.clone().stripZone(),r=t.end.clone().stripZone(),i=this.eventsToNormalRanges(e),s=[],o=e[0],u=n,a,f;i.sort(Nt);for(a=0;a<i.length;a++)f=i[a],f.start>u&&s.push({event:o,start:u,end:f.start}),u=f.end;return u<r&&s.push({event:o,start:u,end:r}),s},eventRangeToSegs:function(e,t){var n,r,i;t?n=t(e.start,e.end):n=this.rangeToSegs(e.start,e.end);for(r=0;r<n.length;r++)i=n[r],i.event=e.event,i.eventStartMS=e.eventStartMS,i.eventDurationMS=e.eventDurationMS;return n}}),kt.prototype=B(wt.prototype),e.extend(kt.prototype,{numbersVisible:!1,cellDuration:t.duration({days:1}),bottomCoordPadding:0,rowEls:null,dayEls:null,helperEls:null,render:function(t){var n=this.view,r="",i;for(i=0;i<n.rowCnt;i++)r+=this.dayRowHtml(i,t);this.el.html(r),this.rowEls=this.el.find(".fc-row"),this.dayEls=this.el.find(".fc-day"),this.dayEls.each(function(t,r){var i=n.cellToDate(Math.floor(t/n.colCnt),t%n.colCnt);n.trigger("dayRender",null,i,e(r))}),wt.prototype.render.call(this)},destroy:function(){this.destroySegPopover()},dayRowHtml:function(e,t){var n=this.view,r=["fc-row","fc-week",n.widgetContentClass];return t&&r.push("fc-rigid"),'<div class="'+r.join(" ")+'">'+'<div class="fc-bg">'+"<table>"+this.rowHtml("day",e)+"</table>"+"</div>"+'<div class="fc-content-skeleton">'+"<table>"+(this.numbersVisible?"<thead>"+this.rowHtml("number",e)+"</thead>":"")+"</table>"+"</div>"+"</div>"},dayCellHtml:function(e,t,n){return this.bgCellHtml(e,t,n)},buildCoords:function(t,n){var r=this.view.colCnt,i,s,o;this.dayEls.slice(0,r).each(function(t,r){i=e(r),s=i.offset().left,t&&(o[1]=s),o=[s],n[t]=o}),o[1]=s+i.outerWidth(),this.rowEls.each(function(n,r){i=e(r),s=i.offset().top,n&&(o[1]=s),o=[s],t[n]=o}),o[1]=s+i.outerHeight()+this.bottomCoordPadding},getCellDate:function(e){return this.view.cellToDate(e)},getCellDayEl:function(e){return this.dayEls.eq(e.row*this.view.colCnt+e.col)},rangeToSegs:function(e,t){return this.view.rangeToSegments(e,t)},renderDrag:function(e,t,n){var r;this.renderHighlight(e,t||this.view.calendar.getDefaultEventEnd(!0,e));if(n&&!n.el.closest(this.el).length)return this.renderRangeHelper(e,t,n),r=this.view.opt("dragOpacity"),r!==undefined&&this.helperEls.css("opacity",r),!0},destroyDrag:function(){this.destroyHighlight(),this.destroyHelper()},renderResize:function(e,t,n){this.renderHighlight(e,t),this.renderRangeHelper(e,t,n)},destroyResize:function(){this.destroyHighlight(),this.destroyHelper()},renderHelper:function(t,n){var r=[],i=this.eventsToSegs([t]),s;i=this.renderFgSegEls(i),s=this.renderSegRows(i),this.rowEls.each(function(t,i){var o=e(i),u=e('<div class="fc-helper-skeleton"><table/></div>'),a;n&&n.row===t?a=n.el.position().top:a=o.find(".fc-content-skeleton tbody").position().top,u.css("top",a).find("table").append(s[t].tbodyEl),o.append(u),r.push(u[0])}),this.helperEls=e(r)},destroyHelper:function(){this.helperEls&&(this.helperEls.remove(),this.helperEls=null)},fillSegTag:"td",renderFill:function(t,n){var r=[],i,s,o;n=this.renderFillSegEls(t,n);for(i=0;i<n.length;i++)s=n[i],o=this.renderFillRow(t,s),this.rowEls.eq(s.row).append(o),r.push(o[0]);return this.elsByFill[t]=e(r),n},renderFillRow:function(t,n){var r=this.view.colCnt,i=n.leftCol,s=n.rightCol+1,o,u;return o=e('<div class="fc-'+t.toLowerCase()+'-skeleton">'+"<table><tr/></table>"+"</div>"),u=o.find("tr"),i>0&&u.append('<td colspan="'+i+'"/>'),u.append(n.el.attr("colspan",s-i)),s<r&&u.append('<td colspan="'+(r-s)+'"/>'),this.bookendCells(u,t),o}}),e.extend(kt.prototype,{rowStructs:null,destroyEvents:function(){this.destroySegPopover(),wt.prototype.destroyEvents.apply(this,arguments)},getSegs:function(){return wt.prototype.getSegs.call(this).concat(this.popoverSegs||[])},renderBgSegs:function(t){var n=e.grep(t,function(e){return e.event.allDay});return wt.prototype.renderBgSegs.call(this,n)},renderFgSegs:function(t){var n;return t=this.renderFgSegEls(t),n=this.rowStructs=this.renderSegRows(t),this.rowEls.each(function(t,r){e(r).find(".fc-content-skeleton > table").append(n[t].tbodyEl)}),t},destroyFgSegs:function(){var e=this.rowStructs||[],t;while(t=e.pop())t.tbodyEl.remove();this.rowStructs=null},renderSegRows:function(e){var t=[],n,r;n=this.groupSegRows(e);for(r=0;r<n.length;r++)t.push(this.renderSegRow(r,n[r]));return t},fgSegHtml:function(e,t){var n=this.view,r=n.opt("isRTL"),i=e.event,s=n.isEventDraggable(i),o=!t&&i.allDay&&e.isEnd&&n.isEventResizable(i),u=this.getSegClasses(e,s,o),a=this.getEventSkinCss(i),f="",l;return u.unshift("fc-day-grid-event"),!i.allDay&&e.isStart&&(f='<span class="fc-time">'+I(n.getEventTimeText(i))+"</span>"),l='<span class="fc-title">'+(I(i.title||"")||"&nbsp;")+"</span>",'<a class="'+u.join(" ")+'"'+(i.url?' href="'+I(i.url)+'"':"")+(a?' style="'+a+'"':"")+">"+'<div class="fc-content">'+(r?l+" "+f:f+" "+l)+"</div>"+(o?'<div class="fc-resizer"/>':"")+"</a>"},renderSegRow:function(t,n){function y(t){while(p<t)g=(l[c-1]||[])[p],g?g.attr("rowspan",parseInt(g.attr("rowspan")||1,10)+1):(g=e("<td/>"),d.append(g)),f[c][p]=g,l[c][p]=g,p++}var r=this.view,i=r.colCnt,s=this.buildSegLevels(n),o=Math.max(1,s.length),u=e("<tbody/>"),a=[],f=[],l=[],c,h,p,d,v,m,g;for(c=0;c<o;c++){h=s[c],p=0,d=e("<tr/>"),a.push([]),f.push([]),l.push([]);if(h)for(v=0;v<h.length;v++){m=h[v],y(m.leftCol),g=e('<td class="fc-event-container"/>').append(m.el),m.leftCol!=m.rightCol?g.attr("colspan",m.rightCol-m.leftCol+1):l[c][p]=g;while(p<=m.rightCol)f[c][p]=g,a[c][p]=m,p++;d.append(g)}y(i),this.bookendCells(d,"eventSkeleton"),u.append(d)}return{row:t,tbodyEl:u,cellMatrix:f,segMatrix:a,segLevels:s,segs:n}},buildSegLevels:function(e){var t=[],n,r,i;e.sort(Ct);for(n=0;n<e.length;n++){r=e[n];for(i=0;i<t.length;i++)if(!Lt(r,t[i]))break;r.level=i,(t[i]||(t[i]=[])).push(r)}for(i=0;i<t.length;i++)t[i].sort(At);return t},groupSegRows:function(e){var t=this.view,n=[],r;for(r=0;r<t.rowCnt;r++)n.push([]);for(r=0;r<e.length;r++)n[e[r].row].push(e[r]);return n}}),e.extend(kt.prototype,{segPopover:null,popoverSegs:null,destroySegPopover:function(){this.segPopover&&this.segPopover.hide()},limitRows:function(e){var t=this.rowStructs||[],n,r;for(n=0;n<t.length;n++)this.unlimitRow(n),e?typeof e=="number"?r=e:r=this.computeRowLevelLimit(n):r=!1,r!==!1&&this.limitRow(n,r)},computeRowLevelLimit:function(e){var t=this.rowEls.eq(e),n=t.height(),r=this.rowStructs[e].tbodyEl.children(),i,s;for(i=0;i<r.length;i++){s=r.eq(i).removeClass("fc-limited");if(s.position().top+s.outerHeight()>n)return i}return!1},limitRow:function(t,n){function T(i){while(u<i)a={row:t,col:u},d=r.getCellSegs(a,n),d.length&&(g=l[n-1][u],x=r.renderMoreLink(a,d),S=e("<div/>").append(x),g.append(S),o.push(S[0])),u++}var r=this,i=this.view,s=this.rowStructs[t],o=[],u=0,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;if(n&&n<s.segLevels.length){f=s.segLevels[n-1],l=s.cellMatrix,c=s.tbodyEl.children().slice(n).addClass("fc-limited").get();for(h=0;h<f.length;h++){p=f[h],T(p.leftCol),m=[],v=0;while(u<=p.rightCol)a={row:t,col:u},d=this.getCellSegs(a,n),m.push(d),v+=d.length,u++;if(v){g=l[n-1][p.leftCol],y=g.attr("rowspan")||1,b=[];for(w=0;w<m.length;w++)E=e('<td class="fc-more-cell"/>').attr("rowspan",y),d=m[w],a={row:t,col:p.leftCol+w},x=this.renderMoreLink(a,[p].concat(d)),S=e("<div/>").append(x),E.append(S),b.push(E[0]),o.push(E[0]);g.addClass("fc-limited").after(e(b)),c.push(g[0])}}T(i.colCnt),s.moreEls=e(o),s.limitedEls=e(c)}},unlimitRow:function(e){var t=this.rowStructs[e];t.moreEls&&(t.moreEls.remove(),t.moreEls=null),t.limitedEls&&(t.limitedEls.removeClass("fc-limited"),t.limitedEls=null)},renderMoreLink:function(t,n){var r=this,i=this.view;return e('<a class="fc-more"/>').text(this.getMoreLinkText(n.length)).on("click",function(s){var o=i.opt("eventLimitClick"),u=i.cellToDate(t),a=e(this),f=r.getCellDayEl(t),l=r.getCellSegs(t),c=r.resliceDaySegs(l,u),h=r.resliceDaySegs(n,u);typeof o=="function"&&(o=i.trigger("eventLimitClick",null,{date:u,dayEl:f,moreEl:a,segs:c,hiddenSegs:h},s)),o==="popover"?r.showSegPopover(u,t,a,c):typeof o=="string"&&i.calendar.zoomTo(u,o)})},showSegPopover:function(e,t,n,r){var i=this,s=this.view,o=n.parent(),u,a;s.rowCnt==1?u=this.view.el:u=this.rowEls.eq(t.row),a={className:"fc-more-popover",content:this.renderSegPopoverContent(e,r),parentEl:this.el,top:u.offset().top,autoHide:!0,viewportConstrain:s.opt("popoverViewportConstrain"),hide:function(){i.segPopover.destroy(),i.segPopover=null,i.popoverSegs=null}},s.opt("isRTL")?a.right=o.offset().left+o.outerWidth()+1:a.left=o.offset().left-1,this.segPopover=new pt(a),this.segPopover.show()},renderSegPopoverContent:function(t,n){var r=this.view,i=r.opt("theme"),s=t.format(r.opt("dayPopoverFormat")),o=e('<div class="fc-header '+r.widgetHeaderClass+'">'+'<span class="fc-close '+(i?"ui-icon ui-icon-closethick":"fc-icon fc-icon-x")+'"></span>'+'<span class="fc-title">'+I(s)+"</span>"+'<div class="fc-clear"/>'+"</div>"+'<div class="fc-body '+r.widgetContentClass+'">'+'<div class="fc-event-container"></div>'+"</div>"),u=o.find(".fc-event-container"),a;n=this.renderFgSegEls(n,!0),this.popoverSegs=n;for(a=0;a<n.length;a++)n[a].cellDate=t,u.append(n[a].el);return o},resliceDaySegs:function(t,n){var r=e.map(t,function(e){return e.event}),i=n.clone().stripTime(),s=i.clone().add(1,"days");return this.eventsToSegs(r,function(e,t){var n=O(e,t,i,s);return n?[n]:[]})},getMoreLinkText:function(e){var t=this.view,n=t.opt("eventLimitText");return typeof n=="function"?n(e):"+"+e+" "+n},getCellSegs:function(e,t){var n=this.rowStructs[e.row].segMatrix,r=t||0,i=[],s;while(r<n.length)s=n[r][e.col],s&&i.push(s),r++;return i}}),Ot.prototype=B(wt.prototype),e.extend(Ot.prototype,{slotDuration:null,snapDuration:null,minTime:null,maxTime:null,dayEls:null,slatEls:null,slatTops:null,helperEl:null,businessHourSegs:null,render:function(){this.processOptions(),this.el.html(this.renderHtml()),this.dayEls=this.el.find(".fc-day"),this.slatEls=this.el.find(".fc-slats tr"),this.computeSlatTops(),this.renderBusinessHours(),wt.prototype.render.call(this)},renderBusinessHours:function(){var e=this.view.calendar.getBusinessHoursEvents();this.businessHourSegs=this.renderFill("businessHours",this.eventsToSegs(e),"bgevent")},renderHtml:function(){return'<div class="fc-bg"><table>'+this.rowHtml("slotBg")+"</table>"+"</div>"+'<div class="fc-slats">'+"<table>"+this.slatRowHtml()+"</table>"+"</div>"},slotBgCellHtml:function(e,t,n){return this.bgCellHtml(e,t,n)},slatRowHtml:function(){var e=this.view,n=e.calendar,r=e.opt("isRTL"),i="",s=this.slotDuration.asMinutes()%15===0,o=t.duration(+this.minTime),u,a,f;while(o<this.maxTime)u=e.start.clone().time(o),a=u.minutes(),f='<td class="fc-axis fc-time '+e.widgetContentClass+'" '+e.axisStyleAttr()+">"+(!s||!a?"<span>"+I(n.formatDate(u,e.opt("axisFormat")))+"</span>":"")+"</td>",i+="<tr "+(a?'class="fc-minor"':"")+">"+(r?"":f)+'<td class="'+e.widgetContentClass+'"/>'+(r?f:"")+"</tr>",o.add(this.slotDuration);return i},processOptions:function(){var e=this.view,n=e.opt("slotDuration"),r=e.opt("snapDuration");n=t.duration(n),r=r?t.duration(r):n,this.slotDuration=n,this.snapDuration=r,this.cellDuration=r,this.minTime=t.duration(e.opt("minTime")),this.maxTime=t.duration(e.opt("maxTime"))},rangeToSegs:function(e,t){var n=this.view,r=[],i,s,o,u,a;e=e.clone().stripZone(),t=t.clone().stripZone();for(s=0;s<n.colCnt;s++)o=n.cellToDate(0,s),u=o.clone().time(this.minTime),a=o.clone().time(this.maxTime),i=O(e,t,u,a),i&&(i.col=s,r.push(i));return r},resize:function(){this.computeSlatTops(),this.updateSegVerticals()},buildCoords:function(n,r){var i=this.view.colCnt,s=this.el.offset().top,o=t.duration(+this.minTime),u=null,a,f;this.dayEls.slice(0,i).each(function(t,n){a=e(n),f=a.offset().left,u&&(u[1]=f),u=[f],r[t]=u}),u[1]=f+a.outerWidth(),u=null;while(o<this.maxTime)f=s+this.computeTimeTop(o),u&&(u[1]=f),u=[f],n.push(u),o.add(this.snapDuration);u[1]=s+this.computeTimeTop(o)},getCellDate:function(e){var t=this.view,n=t.calendar;return n.rezoneDate(t.cellToDate(0,e.col).time(this.minTime+this.snapDuration*e.row))},getCellDayEl:function(e){return this.dayEls.eq(e.col)},computeDateTop:function(e,n){return this.computeTimeTop(t.duration(e.clone().stripZone()-n.clone().stripTime()))},computeTimeTop:function(e){var t=(e-this.minTime)/this.slotDuration,n,r,i,s;return t=Math.max(0,t),t=Math.min(this.slatEls.length,t),n=Math.floor(t),r=t-n,i=this.slatTops[n],r?(s=this.slatTops[n+1],i+(s-i)*r):i},computeSlatTops:function(){var t=[],n;this.slatEls.each(function(r,i){n=e(i).position().top,t.push(n)}),t.push(n+this.slatEls.last().outerHeight()),this.slatTops=t},renderDrag:function(e,t,n){var r;if(n)return this.renderRangeHelper(e,t,n),r=this.view.opt("dragOpacity"),r!==undefined&&this.helperEl.css("opacity",r),!0;this.renderHighlight(e,t||this.view.calendar.getDefaultEventEnd(!1,e))},destroyDrag:function(){this.destroyHelper(),this.destroyHighlight()},renderResize:function(e,t,n){this.renderRangeHelper(e,t,n)},destroyResize:function(){this.destroyHelper()},renderHelper:function(t,n){var r=this.eventsToSegs([t]),i,s,o,u;r=this.renderFgSegEls(r),i=this.renderSegTable(r);for(s=0;s<r.length;s++)o=r[s],n&&n.col===o.col&&(u=n.el,o.el.css({left:u.css("left"),right:u.css("right"),"margin-left":u.css("margin-left"),"margin-right":u.css("margin-right")}));this.helperEl=e('<div class="fc-helper-skeleton"/>').append(i).appendTo(this.el)},destroyHelper:function(){this.helperEl&&(this.helperEl.remove(),this.helperEl=null)},renderSelection:function(e,t){this.view.opt("selectHelper")?this.renderRangeHelper(e,t):this.renderHighlight(e,t)},destroySelection:function(){this.destroyHelper(),this.destroyHighlight()},renderFill:function(t,n,r){var i=this.view,s,o,u,a,f,l,c,h,p,d;if(n.length){n=this.renderFillSegEls(t,n),s=this.groupSegCols(n),r=r||t.toLowerCase(),o=e('<div class="fc-'+r+'-skeleton">'+"<table><tr/></table>"+"</div>"),u=o.find("tr");for(a=0;a<s.length;a++){f=s[a],l=e("<td/>").appendTo(u);if(f.length){c=e('<div class="fc-'+r+'-container"/>').appendTo(l),h=i.cellToDate(0,a);for(p=0;p<f.length;p++)d=f[p],c.append(d.el.css({top:this.computeDateTop(d.start,h),bottom:-this.computeDateTop(d.end,h)}))}}this.bookendCells(u,t),this.el.append(o),this.elsByFill[t]=o}return n}}),e.extend(Ot.prototype,{eventSkeletonEl:null,renderFgSegs:function(t){return t=this.renderFgSegEls(t),this.el.append(this.eventSkeletonEl=e('<div class="fc-content-skeleton"/>').append(this.renderSegTable(t))),t},destroyFgSegs:function(e){this.eventSkeletonEl&&(this.eventSkeletonEl.remove(),this.eventSkeletonEl=null)},renderSegTable:function(t){var n=e("<table><tr/></table>"),r=n.find("tr"),i,s,o,u,a,f;i=this.groupSegCols(t),this.computeSegVerticals(t);for(u=0;u<i.length;u++){a=i[u],Mt(a),f=e('<div class="fc-event-container"/>');for(s=0;s<a.length;s++)o=a[s],o.el.css(this.generateSegPositionCss(o)),o.bottom-o.top<30&&o.el.addClass("fc-short"),f.append(o.el);r.append(e("<td/>").append(f))}return this.bookendCells(r,"eventSkeleton"),n},updateSegVerticals:function(){var e=(this.segs||[]).concat(this.businessHourSegs||[]),t;this.computeSegVerticals(e);for(t=0;t<e.length;t++)e[t].el.css(this.generateSegVerticalCss(e[t]))},computeSegVerticals:function(e){var t,n;for(t=0;t<e.length;t++)n=e[t],n.top=this.computeDateTop(n.start,n.start),n.bottom=this.computeDateTop(n.end,n.start)},fgSegHtml:function(e,t){var n=this.view,r=e.event,i=n.isEventDraggable(r),s=!t&&e.isEnd&&n.isEventResizable(r),o=this.getSegClasses(e,i,s),u=this.getEventSkinCss(r),a,f,l;o.unshift("fc-time-grid-event");if(n.isMultiDayEvent(r)){if(e.isStart||e.isEnd)a=n.getEventTimeText(e.start,e.end),f=n.getEventTimeText(e.start,e.end,"LT"),l=n.getEventTimeText(e.start,null)}else a=n.getEventTimeText(r),f=n.getEventTimeText(r,"LT"),l=n.getEventTimeText(r.start,null);return'<a class="'+o.join(" ")+'"'+(r.url?' href="'+I(r.url)+'"':"")+(u?' style="'+u+'"':"")+">"+'<div class="fc-content">'+(a?'<div class="fc-time" data-start="'+I(l)+'"'+' data-full="'+I(f)+'"'+">"+"<span>"+I(a)+"</span>"+"</div>":"")+(r.title?'<div class="fc-title">'+I(r.title)+"</div>":"")+"</div>"+'<div class="fc-bg"/>'+(s?'<div class="fc-resizer"/>':"")+"</a>"},generateSegPositionCss:function(e){var t=this.view,n=t.opt("isRTL"),r=t.opt("slotEventOverlap"),i=e.backwardCoord,s=e.forwardCoord,o=this.generateSegVerticalCss(e),u,a;return r&&(s=Math.min(1,i+(s-i)*2)),n?(u=1-s,a=i):(u=i,a=1-s),o.zIndex=e.level+1,o.left=u*100+"%",o.right=a*100+"%",r&&e.forwardPressure&&(o[n?"marginLeft":"marginRight"]=20),o},generateSegVerticalCss:function(e){return{top:e.top,bottom:-e.bottom}},groupSegCols:function(e){var t=this.view,n=[],r;for(r=0;r<t.colCnt;r++)n.push([]);for(r=0;r<e.length;r++)n[e[r].col].push(e[r]);return n}}),It.prototype={calendar:null,coordMap:null,el:null,start:null,end:null,intervalStart:null,intervalEnd:null,rowCnt:null,colCnt:null,isSelected:!1,scrollerEl:null,scrollTop:null,widgetHeaderClass:null,widgetContentClass:null,highlightStateClass:null,documentMousedownProxy:null,documentDragStartProxy:null,init:function(){var t=this.opt("theme")?"ui":"fc";this.widgetHeaderClass=t+"-widget-header",this.widgetContentClass=t+"-widget-content",this.highlightStateClass=t+"-state-highlight",this.documentMousedownProxy=e.proxy(this,"documentMousedown"),this.documentDragStartProxy=e.proxy(this,"documentDragStart")},render:function(){this.updateSize(),this.trigger("viewRender",this,this,this.el),e(document).on("mousedown",this.documentMousedownProxy).on("dragstart",this.documentDragStartProxy)},destroy:function(){this.unselect(),this.trigger("viewDestroy",this,this,this.el),this.destroyEvents(),this.el.empty(),e(document).off("mousedown",this.documentMousedownProxy).off("dragstart",this.documentDragStartProxy)},incrementDate:function(e,t){},updateSize:function(e){e&&this.recordScroll(),this.updateHeight(),this.updateWidth()},updateWidth:function(){},updateHeight:function(){var e=this.calendar;this.setHeight(e.getSuggestedViewHeight(),e.isHeightAuto())},setHeight:function(e,t){},computeScrollerHeight:function(e){var t=this.el.add(this.scrollerEl),n;return t.css({position:"relative",left:-1}),n=this.el.outerHeight()-this.scrollerEl.height(),t.css({position:"",left:""}),e-n},recordScroll:function(){this.scrollerEl&&(this.scrollTop=this.scrollerEl.scrollTop())},restoreScroll:function(){this.scrollTop!==null&&this.scrollerEl.scrollTop(this.scrollTop)},renderEvents:function(e){this.segEach(function(e){this.trigger("eventAfterRender",e.event,e.event,e.el)}),this.trigger("eventAfterAllRender")},destroyEvents:function(){this.segEach(function(e){this.trigger("eventDestroy",e.event,e.event,e.el)})},resolveEventEl:function(t,n){var r=this.trigger("eventRender",t,t,n);return r===!1?n=null:r&&r!==!0&&(n=e(r)),n},showEvent:function(e){this.segEach(function(e){e.el.css("visibility","")},e)},hideEvent:function(e){this.segEach(function(e){e.el.css("visibility","hidden")},e)},segEach:function(e,t){var n=this.getSegs(),r;for(r=0;r<n.length;r++)(!t||n[r].event._id===t._id)&&e.call(this,n[r])},getSegs:function(){},renderDrag:function(e,t,n){},destroyDrag:function(){},documentDragStart:function(t,n){var r=this,i=this.calendar,s=null,o=null,u=null,a,f,l,c,h;if(this.opt("droppable")){a=e(t.target),f=this.opt("dropAccept");if(e.isFunction(f)?f.call(a[0],a):a.is(f))l=qt(a),c=l.eventProps,h=new mt(this.coordMap,{cellOver:function(t,n){s=n,o=l.duration?s.clone().add(l.duration):null,u=o||i.getDefaultEventEnd(!s.hasTime(),s),c&&e.extend(c,{start:s,end:o}),i.isExternalDragAllowedInRange(s,u,c)?r.renderDrag(s,u):(s=null,w())},cellOut:function(){s=null,r.destroyDrag(),E()}}),e(document).one("dragstop",function(e,t){var n;r.destroyDrag(),E(),s&&(l.startTime&&!s.hasTime()&&s.time(l.startTime),r.trigger("drop",a[0],s,e,t),c&&(n=i.renderEvent(c,l.stick),r.trigger("eventReceive",null,n[0])))}),h.startDrag(t)}},select:function(e,t,n){this.unselect(n),this.renderSelection(e,t),this.reportSelection(e,t,n)},renderSelection:function(e,t){},reportSelection:function(e,t,n){this.isSelected=!0,this.trigger("select",null,e,t,n)},unselect:function(e){this.isSelected&&(this.isSelected=!1,this.destroySelection(),this.trigger("unselect",null,e))},destroySelection:function(){},documentMousedown:function(t){var n;this.isSelected&&this.opt("unselectAuto")&&A(t)&&(n=this.opt("unselectCancel"),(!n||!e(t.target).closest(n).length)&&this.unselect(t))}},u.dataAttrPrefix="",Rt.prototype=B(It.prototype),e.extend(Rt.prototype,{dayGrid:null,dayNumbersVisible:!1,weekNumbersVisible:!1,weekNumberWidth:null,headRowEl:null,render:function(e,t,n){this.rowCnt=e,this.colCnt=t,this.dayNumbersVisible=n,this.weekNumbersVisible=this.opt("weekNumbers"),this.dayGrid.numbersVisible=this.dayNumbersVisible||this.weekNumbersVisible,this.el.addClass("fc-basic-view").html(this.renderHtml()),this.headRowEl=this.el.find("thead .fc-row"),this.scrollerEl=this.el.find(".fc-day-grid-container"),this.dayGrid.coordMap.containerEl=this.scrollerEl,this.dayGrid.el=this.el.find(".fc-day-grid"),this.dayGrid.render(this.hasRigidRows()),It.prototype.render.call(this)},destroy:function(){this.dayGrid.destroy(),It.prototype.destroy.call(this)},renderHtml:function(){return'<table><thead><tr><td class="'+this.widgetHeaderClass+'">'+this.dayGrid.headHtml()+"</td>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+'<td class="'+this.widgetContentClass+'">'+'<div class="fc-day-grid-container">'+'<div class="fc-day-grid"/>'+"</div>"+"</td>"+"</tr>"+"</tbody>"+"</table>"},headIntroHtml:function(){if(this.weekNumbersVisible)return'<th class="fc-week-number '+this.widgetHeaderClass+'" '+this.weekNumberStyleAttr()+">"+"<span>"+I(this.opt("weekNumberTitle"))+"</span>"+"</th>"},numberIntroHtml:function(e){if(this.weekNumbersVisible)return'<td class="fc-week-number" '+this.weekNumberStyleAttr()+">"+"<span>"+this.calendar.calculateWeekNumber(this.cellToDate(e,0))+"</span>"+"</td>"},dayIntroHtml:function(){if(this.weekNumbersVisible)return'<td class="fc-week-number '+this.widgetContentClass+'" '+this.weekNumberStyleAttr()+"></td>"},introHtml:function(){if(this.weekNumbersVisible)return'<td class="fc-week-number" '+this.weekNumberStyleAttr()+"></td>"},numberCellHtml:function(e,t,n){var r;return this.dayNumbersVisible?(r=this.dayGrid.getDayClasses(n),r.unshift("fc-day-number"),'<td class="'+r.join(" ")+'" data-date="'+n.format()+'">'+n.date()+"</td>"):"<td/>"},weekNumberStyleAttr:function(){return this.weekNumberWidth!==null?'style="width:'+this.weekNumberWidth+'px"':""},hasRigidRows:function(){var e=this.opt("eventLimit");return e&&typeof e!="number"},updateWidth:function(){this.weekNumbersVisible&&(this.weekNumberWidth=T(this.el.find(".fc-week-number")))},setHeight:function(e,t){var n=this.opt("eventLimit"),r;C(this.scrollerEl),b(this.headRowEl),this.dayGrid.destroySegPopover(),n&&typeof n=="number"&&this.dayGrid.limitRows(n),r=this.computeScrollerHeight(e),this.setGridHeight(r,t),n&&typeof n!="number"&&this.dayGrid.limitRows(n),!t&&N(this.scrollerEl,r)&&(y(this.headRowEl,L(this.scrollerEl)),r=this.computeScrollerHeight(e),this.scrollerEl.height(r),this.restoreScroll())},setGridHeight:function(e,t){t?x(this.dayGrid.rowEls):S(this.dayGrid.rowEls,e,!0)},renderEvents:function(e){this.dayGrid.renderEvents(e),this.updateHeight(),It.prototype.renderEvents.call(this,e)},getSegs:function(){return this.dayGrid.getSegs()},destroyEvents:function(){It.prototype.destroyEvents.call(this),this.recordScroll(),this.dayGrid.destroyEvents()},renderDrag:function(e,t,n){return this.dayGrid.renderDrag(e,t,n)},destroyDrag:function(){this.dayGrid.destroyDrag()},renderSelection:function(e,t){this.dayGrid.renderSelection(e,t)},destroySelection:function(){this.dayGrid.destroySelection()}}),f({fixedWeekCount:!0}),a.month=Ut,Ut.prototype=B(Rt.prototype),e.extend(Ut.prototype,{name:"month",incrementDate:function(e,t){return e.clone().stripTime().add(t,"months").startOf("month")},render:function(e){var t;this.intervalStart=e.clone().stripTime().startOf("month"),this.intervalEnd=this.intervalStart.clone().add(1,"months"),this.start=this.intervalStart.clone(),this.start=this.skipHiddenDays(this.start),this.start.startOf("week"),this.start=this.skipHiddenDays(this.start),this.end=this.intervalEnd.clone(),this.end=this.skipHiddenDays(this.end,-1,!0),this.end.add((7-this.end.weekday())%7,"days"),this.end=this.skipHiddenDays(this.end,-1,!0),t=Math.ceil(this.end.diff(this.start,"weeks",!0)),this.isFixedWeeks()&&(this.end.add(6-t,"weeks"),t=6),this.title=this.calendar.formatDate(this.intervalStart,this.opt("titleFormat")),Rt.prototype.render.call(this,t,this.getCellsPerWeek(),!0)},setGridHeight:function(e,t){t=t||this.opt("weekMode")==="variable",t&&(e*=this.rowCnt/6),S(this.dayGrid.rowEls,e,!t)},isFixedWeeks:function(){var e=this.opt("weekMode");return e?e==="fixed":this.opt("fixedWeekCount")}}),a.basicWeek=zt,zt.prototype=B(Rt.prototype),e.extend(zt.prototype,{name:"basicWeek",incrementDate:function(e,t){return e.clone().stripTime().add(t,"weeks").startOf("week")},render:function(e){this.intervalStart=e.clone().stripTime().startOf("week"),this.intervalEnd=this.intervalStart.clone().add(1,"weeks"),this.start=this.skipHiddenDays(this.intervalStart),this.end=this.skipHiddenDays(this.intervalEnd,-1,!0),this.title=this.calendar.formatRange(this.start,this.end.clone().subtract(1),this.opt("titleFormat")," — "),Rt.prototype.render.call(this,1,this.getCellsPerWeek(),!1)}}),a.basicDay=Wt,Wt.prototype=B(Rt.prototype),e.extend(Wt.prototype,{name:"basicDay",incrementDate:function(e,t){var n=e.clone().stripTime().add(t,"days");return n=this.skipHiddenDays(n,t<0?-1:1),n},render:function(e){this.start=this.intervalStart=e.clone().stripTime(),this.end=this.intervalEnd=this.start.clone().add(1,"days"),this.title=this.calendar.formatDate(this.start,this.opt("titleFormat")),Rt.prototype.render.call(this,1,1,!1)}}),f({allDaySlot:!0,allDayText:"all-day",scrollTime:"06:00:00",slotDuration:"00:30:00",axisFormat:Vt,timeFormat:{agenda:$t},minTime:"00:00:00",maxTime:"24:00:00",slotEventOverlap:!0});var Xt=5;Jt.prototype=B(It.prototype),e.extend(Jt.prototype,{timeGrid:null,dayGrid:null,axisWidth:null,noScrollRowEls:null,bottomRuleEl:null,bottomRuleHeight:null,render:function(t){this.rowCnt=1,this.colCnt=t,this.el.addClass("fc-agenda-view").html(this.renderHtml()),this.scrollerEl=this.el.find(".fc-time-grid-container"),this.timeGrid.coordMap.containerEl=this.scrollerEl,this.timeGrid.el=this.el.find(".fc-time-grid"),this.timeGrid.render(),this.bottomRuleEl=e('<hr class="'+this.widgetHeaderClass+'"/>').appendTo(this.timeGrid.el),this.dayGrid&&(this.dayGrid.el=this.el.find(".fc-day-grid"),this.dayGrid.render(),this.dayGrid.bottomCoordPadding=this.dayGrid.el.next("hr").outerHeight()),this.noScrollRowEls=this.el.find(".fc-row:not(.fc-scroller *)"),It.prototype.render.call(this),this.resetScroll()},destroy:function(){this.timeGrid.destroy(),this.dayGrid&&this.dayGrid.destroy(),It.prototype.destroy.call(this)},renderHtml:function(){return'<table><thead><tr><td class="'+this.widgetHeaderClass+'">'+this.timeGrid.headHtml()+"</td>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+'<td class="'+this.widgetContentClass+'">'+(this.dayGrid?'<div class="fc-day-grid"/><hr class="'+this.widgetHeaderClass+'"/>':"")+'<div class="fc-time-grid-container">'+'<div class="fc-time-grid"/>'+"</div>"+"</td>"+"</tr>"+"</tbody>"+"</table>"},headIntroHtml:function(){var e,t,n,r;return this.opt("weekNumbers")?(e=this.cellToDate(0,0),t=this.calendar.calculateWeekNumber(e),n=this.opt("weekNumberTitle"),this.opt("isRTL")?r=t+n:r=n+t,'<th class="fc-axis fc-week-number '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+">"+"<span>"+I(r)+"</span>"+"</th>"):'<th class="fc-axis '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+"></th>"},dayIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+">"+"<span>"+(this.opt("allDayHtml")||I(this.opt("allDayText")))+"</span>"+"</td>"},slotBgIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+"></td>"},introHtml:function(){return'<td class="fc-axis" '+this.axisStyleAttr()+"></td>"},axisStyleAttr:function(){return this.axisWidth!==null?'style="width:'+this.axisWidth+'px"':""},updateSize:function(e){e&&this.timeGrid.resize(),It.prototype.updateSize.call(this,e)},updateWidth:function(){this.axisWidth=T(this.el.find(".fc-axis"))},setHeight:function(e,t){var n,r;this.bottomRuleHeight===null&&(this.bottomRuleHeight=this.bottomRuleEl.outerHeight()),this.bottomRuleEl.hide(),this.scrollerEl.css("overflow",""),C(this.scrollerEl),b(this.noScrollRowEls),this.dayGrid&&(this.dayGrid.destroySegPopover(),n=this.opt("eventLimit"),n&&typeof n!="number"&&(n=Xt),n&&this.dayGrid.limitRows(n)),t||(r=this.computeScrollerHeight(e),N(this.scrollerEl,r)?(y(this.noScrollRowEls,L(this.scrollerEl)),r=this.computeScrollerHeight(e),this.scrollerEl.height(r),this.restoreScroll()):(this.scrollerEl.height(r).css("overflow","hidden"),this.bottomRuleEl.show()))},resetScroll:function(){function i(){e.scrollerEl.scrollTop(r)}var e=this,n=t.duration(this.opt("scrollTime")),r=this.timeGrid.computeTimeTop(n);r=Math.ceil(r),r&&r++,i(),setTimeout(i,0)},renderEvents:function(e){var t=[],n=[],r=[],i,s;for(s=0;s<e.length;s++)e[s].allDay?t.push(e[s]):n.push(e[s]);i=this.timeGrid.renderEvents(n),this.dayGrid&&(r=this.dayGrid.renderEvents(t)),this.updateHeight(),It.prototype.renderEvents.call(this,e)},getSegs:function(){return this.timeGrid.getSegs().concat(this.dayGrid?this.dayGrid.getSegs():[])},destroyEvents:function(){It.prototype.destroyEvents.call(this),this.recordScroll(),this.timeGrid.destroyEvents(),this.dayGrid&&this.dayGrid.destroyEvents()},renderDrag:function(e,t,n){if(e.hasTime())return this.timeGrid.renderDrag(e,t,n);if(this.dayGrid)return this.dayGrid.renderDrag(e,t,n)},destroyDrag:function(){this.timeGrid.destroyDrag(),this.dayGrid&&this.dayGrid.destroyDrag()},renderSelection:function(e,t){e.hasTime()||t.hasTime()?this.timeGrid.renderSelection(e,t):this.dayGrid&&this.dayGrid.renderSelection(e,t)},destroySelection:function(){this.timeGrid.destroySelection(),this.dayGrid&&this.dayGrid.destroySelection()}}),a.agendaWeek=Kt,Kt.prototype=B(Jt.prototype),e.extend(Kt.prototype,{name:"agendaWeek",incrementDate:function(e,t){return e.clone().stripTime().add(t,"weeks").startOf("week")},render:function(e){this.intervalStart=e.clone().stripTime().startOf("week"),this.intervalEnd=this.intervalStart.clone().add(1,"weeks"),this.start=this.skipHiddenDays(this.intervalStart),this.end=this.skipHiddenDays(this.intervalEnd,-1,!0),this.title=this.calendar.formatRange(this.start,this.end.clone().subtract(1),this.opt("titleFormat")," — "),Jt.prototype.render.call(this,this.getCellsPerWeek())}}),a.agendaDay=Qt,Qt.prototype=B(Jt.prototype),e.extend(Qt.prototype,{name:"agendaDay",incrementDate:function(e,t){var n=e.clone().stripTime().add(t,"days");return n=this.skipHiddenDays(n,t<0?-1:1),n},render:function(e){this.start=this.intervalStart=e.clone().stripTime(),this.end=this.intervalEnd=this.start.clone().add(1,"days"),this.title=this.calendar.formatDate(this.start,this.opt("titleFormat")),Jt.prototype.render.call(this,1)}})}),function(e){"function"==typeof define&&define.amd?define("controller/zh-cn",["jquery","moment","fullcalendar"],e):e(jQuery,moment)}(function(e,t){(t.defineLocale||t.lang).call(t,"zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm",LTS:"Ah点m分s秒",L:"YYYY-MM-DD",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY-MM-DD",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(e,t){var n=100*e+t;return 600>n?"凌晨":900>n?"早上":1130>n?"上午":1230>n?"中午":1800>n?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var e,n;return e=t().startOf("week"),n=this.unix()-e.unix()>=604800?"[下]":"[本]",0===this.minutes()?n+"dddAh点整":n+"dddAh点mm"},lastWeek:function(){var e,n;return e=t().startOf("week"),n=this.unix()<e.unix()?"[上]":"[本]",0===this.minutes()?n+"dddAh点整":n+"dddAh点mm"},sameElse:"LL"},ordinalParse:/\d{1,2}(日|月|周)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"},week:{dow:1,doy:4}}),e.fullCalendar.datepickerLang("zh-cn","zh-CN",{closeText:"关闭",prevText:"&#x3C;上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"}),e.fullCalendar.lang("zh-cn",{defaultButtonText:{month:"月",week:"周",day:"日",list:"日程"},allDayText:"全天",eventLimitText:function(e){return"另外 "+e+" 个"}})}),define("controller/calendar",["jquery","fullcalendar","./zh-cn"],function(e){function r(){t.fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},defaultView:"month",lang:"zh-cn",selectable:!0,unselectCancel:"#event-form,.ui-dialog-buttonpane",editable:!0,eventLimit:!0,weekNumbers:!0,selectHelper:!0,slotEventOverlap:!1,scrollTime:"08:30:00",droppable:!0,eventDrop:function(n,r,i){e.ajax({type:"get",url:"/api/updateNote?callback=?",dataType:"jsonp",data:{_id:n._id,type:n.type,title:n.title,remark:n.remark,status:n.status,start:n.start.format(),end:n.end?n.end.format():""},scriptCharset:"utf-8",success:function(e){if(e.status="success")t.fullCalendar("renderEvent",n,!0),t.fullCalendar("unselect")}})},drop:function(){e("#drop-remove").is(":checked")&&e(this).remove()},eventReceive:function(n){console.log(n),t.fullCalendar("unselect"),start=n.start,e.ajax({type:"get",url:"/api/saveNote?callback=?",dataType:"jsonp",data:{user:currentUser,type:n.type||"1",title:n.title,remark:n.remark||"",status:n.status||"1",start:start.format(),end:n._allDay?start.add("1","days").format():start.add("2","h").format()},scriptCharset:"utf-8",success:function(e){t.fullCalendar("removeEvents"),t.fullCalendar("refetchEvents")}}),t.fullCalendar("unselect")},eventAfterRender:function(e,t,n){},eventResize:function(n,r,i){e.ajax({type:"get",url:"/api/updateNote?callback=?",dataType:"jsonp",data:{_id:n._id,type:n.type,title:n.title,remark:n.remark,status:n.status,start:n.start.format(),end:n.end.format()},scriptCharset:"utf-8",success:function(e){(e.status="success")&&t.fullCalendar("renderEvent",n,!0)}}),t.fullCalendar("unselect")},select:function(n,r,i,s){e("#event-type").get(0).selectedIndex=0,e("#event-status").get(0).selectedIndex=0,e("#event-dialog").dialog({modal:!0,position:{my:"center top+40",at:"center top",of:window},width:360,buttons:[{text:"保存",click:function(i){i.preventDefault();var s=this,o=e("#event-status").val();o!="4"&&e.ajax({type:"get",url:"/api/saveNote?callback=?",dataType:"jsonp",data:{user:currentUser,type:e("#event-type").val(),title:e("#event-title").val(),remark:e("#event-remark").val(),status:e("#event-status").val(),start:n.format(),end:r.format()},scriptCharset:"utf-8",success:function(n){if(n.status="success")e(s).dialog("close"),t.fullCalendar("removeEvents"),t.fullCalendar("refetchEvents"),t.fullCalendar("unselect")}})}},{text:"取消",click:function(n){n.preventDefault(),e(this).dialog("close"),t.fullCalendar("unselect")}}]})},eventClick:function(n,r,i){e.ajax({type:"get",url:"/api/getNote?callback=?",dataType:"jsonp",data:{_id:n._id},scriptCharset:"utf-8"}).done(function(r){var i=Number(r.type),s=Number(r.status);e("#event-type").get(0).selectedIndex=i>0?i-1:0,e("#event-title").val(r.title),e("#event-remark").val(r.remark),e("#event-status").get(0).selectedIndex=s>0?s-1:0,e("#event-dialog").dialog({modal:!0,position:{my:"center top+40",at:"center top",of:window},width:360,open:function(t,n){e(this).parent().focus()},buttons:[{text:"保存",click:function(i){i.preventDefault();var s=this,o=e("#event-type").val(),u=e("#event-title").val(),a=e("#event-remark").val(),f=e("#event-status").val();n.type=o,n.title=u,n.remark=a,n.status=f,f=="3"?(n.borderColor="#43a102",n.backgroundColor="#43a102"):f=="2"?(n.borderColor="#f6bf1c",n.backgroundColor="#f6bf1c"):f=="1"&&(n.borderColor="",n.backgroundColor=""),f=="4"?e.ajax({type:"get",url:"/api/removeNote?callback=?",dataType:"jsonp",data:{_id:r._id},scriptCharset:"utf-8"}).done(function(r){e("#event-dialog").dialog("close"),t.fullCalendar("removeEvents",n._id),t.fullCalendar("unselect")}):e.ajax({type:"get",url:"/api/updateNote?callback=?",dataType:"jsonp",data:{_id:r._id,type:o,title:u,remark:a,status:f,start:n.start.format(),end:n.end.format()},scriptCharset:"utf-8",success:function(r){if(r.status="success")e(s).dialog("close"),t.fullCalendar("renderEvent",n,!0)}})}},{text:"取消",click:function(t){t.preventDefault(),e(this).dialog("close")}}]}),t.fullCalendar("unselect")})},events:function(t,r,i,s){e.ajax({type:"get",url:"/api/getNotes?callback=?",dataType:"jsonp",data:{user:n,start:t.format(),end:r.format()},scriptCharset:"utf-8"}).done(function(t){var n=[];e(t.list).each(function(t,r){var i={_id:e(this).attr("_id"),type:e(this).attr("type"),title:e(this).attr("title"),remark:e(this).attr("remark"),status:e(this).attr("status"),start:e(this).attr("start"),end:e(this).attr("end")};r.status=="3"?(i.borderColor="#67BF74",i.backgroundColor="#67BF74"):r.status=="2"&&(i.borderColor="#f6bf1c",i.backgroundColor="#f6bf1c"),n.push(i)}),s(n)})},loading:function(t){e("#loading").toggle(t)}})}var t=e("#main");e("#event-form").unbind().submit(function(t){t.preventDefault(),e(".ui-dialog-buttonset button:eq(0)").trigger("click")});var n=currentUser;return{init:function(e){isHaveCalendar=!0,n=e,r()},render:function(){t.fullCalendar("render")},destroy:function(){isHaveCalendar=!1,t.fullCalendar("destroy")},reload:function(e){n=e,t.fullCalendar("removeEvents"),t.fullCalendar("refetchEvents")}}}),define("route",["jquery","underscore","backbone","moment","view/search","view/group","view/mail","view/syncCalendar","controller/search","controller/calendar","controller/defaultTime"],function(e,t,n,r,i,s,o,u,a,f,l){var c=e(".container"),h=e("#main"),p=window.innerHeight;h.css({"min-height":p-59-67-40}),e.ajax({type:"get",url:"/api/getRecentlyNotes?callback=?",dataType:"jsonp",data:{user:currentUser},scriptCharset:"utf-8",success:function(t){var n=t.list,r=n.length,i="";for(var s=0;s<r;s++)i+='<li class="recently-event">'+n[s].title+"</li>";e("#recently-events").html(i),e("#recently-events .recently-event").each(function(t,r){e(this).data("event",{title:e.trim(e(this).text()),type:n[t].type,status:n[t].status,stick:!0}),e(this).draggable({zIndex:999,revert:!0,revertDuration:0})})}}),e("#bar-more-week").attr("href","#archive/user/"+currentUser+"/"+l.start+"/"+l.end),e("#bar-menu-btn").click(function(t){t.preventDefault(),e("#recently").toggle(),c.css("margin-left")=="400px"?c.css({"margin-left":"230px"}):c.css({"margin-left":"400px"})}),e(".bar-more-btn").click(function(t){t.preventDefault(),e(".bar-more-nav").toggle()}),e(".bar-more-nav").delegate("a","click",function(t){e(".bar-more-nav").toggle()});var d=new i;return a(),n.Router.extend({routes:{"":"default","user/:name":"swtichUser",group:"group",google:"syncCalendar",sendMail:"sendMail","archive/user/:name/:start/:end":"archiveUser","archive/group/:name/:start/:end":"archiveGroup","userToMail/:name/:start/:end/:mail":"userToMail","groupTomail/:name/:start/:end":"groupToMail"},"default":function(){document.title="小蜜蜂",h.empty(),isHaveCalendar?f.reload(name):f.init(currentUser)},group:function(){document.title="用户组管理-小蜜蜂",isHaveCalendar&&(f.destroy(),isHaveCalendar=!1);var e=this,r=n.Model.extend({defaults:{name:"",members:"",mail:""},url:function(){return t.isUndefined(this.id)?"/api/group":"/api/group?_id="+this.id},idAttribute:"_id",sync:function(e,t,r){return r.dataType="jsonp",n.sync(e,t,r)}}),i=n.Collection.extend({model:r,url:"/api/getGroups",sync:function(e,t,r){return r.dataType="jsonp",n.sync(e,t,r)},parse:function(e){return e.list}}),o=new i;o.fetch({success:function(t,n,r){e.changeView(new s({collection:t}))},error:function(e,t,n){console.log(t.statusText)},timeout:5e3})},syncCalendar:function(){document.title="同步Google日历-小蜜蜂",isHaveCalendar&&(f.destroy(),isHaveCalendar=!1);var r=this,i=n.Model.extend({defaults:{user:"",record:"",start:"",end:"",count:"",time:""},url:function(){return t.isUndefined(this.id)?"/api/record":"/api/record?id="+this.id},idAttribute:"_id",sync:function(e,t,r){return r.dataType="jsonp",n.sync(e,t,r)}}),s=n.Collection.extend({model:i,url:"/api/getRecords",sync:function(e,t,r){return r.dataType="jsonp",n.sync(e,t,r)},parse:function(e){return e.list}}),o=new s;o.fetch({success:function(t,n,i){r.changeView(new u({collection:t})),e("#from").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,numberOfMonths:2,onClose:function(t){e("#to").datepicker("option","minDate",t)}}),e("#to").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,numberOfMonths:2,onClose:function(t){e("#from").datepicker("option","maxDate",t)}})},error:function(e,t,n){console.log(t.statusText)},timeout:5e3})},swtichUser:function(e){isHaveCalendar?f.reload(e):f.init(e)},archiveUser:function(t,n,i){document.title="个人周报-小蜜蜂",isHaveCalendar&&(f.destroy(),isHaveCalendar=!1),e.ajax({type:"get",url:"/api/getNotes?callback=?",dataType:"jsonp",data:{user:t,start:n,end:r(i).add(1,"days").format()},scriptCharset:"utf-8"}).done(function(e){var t=e.list,r=t.length,s=["工作需求","自主学习","其它"],o=["未完成","进行中","已完成"],u='<table class="ui-table"><caption>周报('+n+"至"+i+')</caption><thead><th width="60">姓名</th><th>任务</th><th width="270">时间段</th><th width="60">本周耗时</th><th width="60">状态</th><th width="180">备注</th></thead><tbody class="ui-tbody">';for(var a=0;a<r;a++)a==0?u+='<tr><td class="ui-center" rowspan="'+r+'">'+t[a].user+'</td><td class="archive-task">'+t[a].title+"("+s[Number(t[a].type)-1]+')</td><td class="ui-center">'+t[a].start+"至"+t[a].end+'</td><td class="ui-center">'+(((new Date(t[a].end)).getTime()-(new Date(t[a].start)).getTime())/36e5).toFixed(2)+'时</td><td class="ui-center">'+o[Number(t[a].status)-1]+'</td><td class="ui-center">'+t[a].remark+"</td></tr>":u+='<td class="archive-task">'+t[a].title+"("+s[Number(t[a].type)-1]+')</td><td class="ui-center">'+t[a].start+"至"+t[a].end+'</td><td class="ui-center">'+(((new Date(t[a].end)).getTime()-(new Date(t[a].start)).getTime())/36e5).toFixed(2)+'时</td><td class="ui-center">'+o[Number(t[a].status)-1]+'</td><td class="ui-center">'+t[a].remark+"</td></tr>";u+="</tbody></table>",h.html(u)})},archiveGroup:function(t,n,i){document.title=t+"周报-小蜜蜂",isHaveCalendar&&(f.destroy(),isHaveCalendar=!1);var s=["工作需求","自主学习","其它"],o=["未完成","进行中","已完成"],u='<table class="ui-table"><caption>周报('+n+"至"+i+')</caption><thead><th>姓名</th><th>任务</th><th>时间段</th><th>本周耗时</th><th>状态</th><th>备注</th></thead><tbody class="ui-tbody">';e.ajax({type:"get",url:"/api/getGroupByName?callback=?",dataType:"jsonp",data:{name:t},scriptCharset:"utf-8"}).done(function(t){var a=t.members.split(","),f=a.length,l=0;for(var c=0;c<f;c++)e.ajax({type:"get",url:"/api/getNotes?callback=?",dataType:"jsonp",data:{user:a[c],start:n,end:r(i).add(1,"days").format()},scriptCharset:"utf-8"}).done(function(e){l++;var t=e.list,n=t.length;for(var r=0;r<n;r++)r==0?u+='<tr><td class="ui-center" rowspan="'+n+'">'+t[r].user+'</td><td class="archive-task">'+t[r].title+"("+s[Number(t[r].type)-1]+')</td><td class="ui-center">'+t[r].start+"至"+t[r].end+'</td><td class="ui-center">'+(((new Date(t[r].end)).getTime()-(new Date(t[r].start)).getTime())/36e5).toFixed(2)+'时</td><td class="ui-center">'+o[Number(t[r].status)-1]+'</td><td class="ui-center">'+t[r].remark+"</td></tr>":u+='<td class="archive-task">'+t[r].title+"("+s[Number(t[r].type)-1]+')</td><td class="ui-center">'+t[r].start+"至"+t[r].end+'</td><td class="ui-center">'+(((new Date(t[r].end)).getTime()-(new Date(t[r].start)).getTime())/36e5).toFixed(2)+'时</td><td class="ui-center">'+o[Number(t[r].status)-1]+'</td><td class="ui-center">'+t[r].remark+"</td></tr>";l==f&&(u+="</tbody></table>",h.html(u))})})},sendMail:function(){document.title="发送邮件-小蜜蜂",isHaveCalendar&&(f.destroy(),isHaveCalendar=!1),this.changeView(new o({})),e("#from").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,numberOfMonths:2,onClose:function(t){e("#to").datepicker("option","minDate",t)}}),e("#to").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,numberOfMonths:2,onClose:function(t){e("#from").datepicker("option","maxDate",t)}})},changeView:function(e){if(this.currentView){if(this.currentView==e)return;this.currentView.remove()}h.html(e.render().el),this.currentView=e}})}),require.config({paths:{jquery:"http://libs.baidu.com/jquery/2.0.0/jquery.min",jqueryUI:"http://libs.baidu.com/jqueryui/1.10.4/jquery-ui.min",underscore:"lib/underscore",backbone:"lib/backbone",moment:"lib/moment",fullcalendar:"lib/fullcalendar",template:"models/template",qrcode:"lib/qrcode"},shim:{backbone:{deps:["underscore","jquery"],exports:"Backbone"},underscore:{exports:"_"}}});var isHaveCalendar=!1;require(["route"],function(e){window.route=new e,Backbone.history.start()}),define("main",function(){});